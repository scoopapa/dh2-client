{
  "version": 3,
  "sources": ["../../../../data/mods/toho/scripts.ts"],
  "sourcesContent": ["import {Dex} from '../../../sim/dex';\nexport const Scripts: {[k: string]: ModdedBattleScriptsData} = {\n\tgen: 9,\n\tteambuilderConfig: {\n\t\t// for micrometas to only show custom tiers\n\t\texcludeStandardTiers: true,\n\t\t// only to specify the order of custom tiers\n\t\tcustomTiers: ['Toho'],\n\t\tcustomDoublesTiers: ['DToho'],\n\t},\t\n\t\n\tinit() {\n\n\t},\n\tbattle: {\n\t\t//inherit: true,\n\t\tendTurn() {\n\t\t\tthis.turn++;\n\t\t\tthis.lastSuccessfulMoveThisTurn = null;\n\n\t\t\tconst dynamaxEnding: Pokemon[] = [];\n\t\t\tfor (const pokemon of this.getAllActive()) {\n\t\t\t\tif (pokemon.volatiles['dynamax']?.turns === 1) {\n\t\t\t\t\tdynamaxEnding.push(pokemon);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (dynamaxEnding.length > 1) {\n\t\t\t\tthis.updateSpeed();\n\t\t\t\tthis.speedSort(dynamaxEnding);\n\t\t\t}\n\t\t\tfor (const pokemon of dynamaxEnding) {\n\t\t\t\tpokemon.removeVolatile('dynamax');\n\t\t\t}\n\n\t\t\t// Gen 1 partial trapping ends when either Pokemon or a switch in faints to residual damage\n\t\t\tif (this.gen === 1) {\n\t\t\t\tfor (const pokemon of this.getAllActive()) {\n\t\t\t\t\tif (pokemon.volatiles['partialtrappinglock']) {\n\t\t\t\t\t\tconst target = pokemon.volatiles['partialtrappinglock'].locked;\n\t\t\t\t\t\tif (target.hp <= 0 || !target.volatiles['partiallytrapped']) {\n\t\t\t\t\t\t\tdelete pokemon.volatiles['partialtrappinglock'];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (pokemon.volatiles['partiallytrapped']) {\n\t\t\t\t\t\tconst source = pokemon.volatiles['partiallytrapped'].source;\n\t\t\t\t\t\tif (source.hp <= 0 || !source.volatiles['partialtrappinglock']) {\n\t\t\t\t\t\t\tdelete pokemon.volatiles['partiallytrapped'];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst trappedBySide: boolean[] = [];\n\t\t\tconst stalenessBySide: ('internal' | 'external' | undefined)[] = [];\n\t\t\tfor (const side of this.sides) {\n\t\t\t\tlet sideTrapped = true;\n\t\t\t\tlet sideStaleness: 'internal' | 'external' | undefined;\n\t\t\t\tfor (const pokemon of side.active) {\n\t\t\t\t\tif (!pokemon) continue;\n\t\t\t\t\tpokemon.moveThisTurn = '';\n\t\t\t\t\tpokemon.newlySwitched = false;\n\t\t\t\t\tpokemon.moveLastTurnResult = pokemon.moveThisTurnResult;\n\t\t\t\t\tpokemon.moveThisTurnResult = undefined;\n\t\t\t\t\tif (this.turn !== 1) {\n\t\t\t\t\t\tpokemon.usedItemThisTurn = false;\n\t\t\t\t\t\tpokemon.statsRaisedThisTurn = false;\n\t\t\t\t\t\tpokemon.statsLoweredThisTurn = false;\n\t\t\t\t\t\t// It shouldn't be possible in a normal battle for a Pokemon to be damaged before turn 1's move selection\n\t\t\t\t\t\t// However, this could be potentially relevant in certain OMs\n\t\t\t\t\t\tpokemon.hurtThisTurn = null;\n\t\t\t\t\t}\n\n\t\t\t\t\tpokemon.maybeDisabled = false;\n\t\t\t\t\tfor (const moveSlot of pokemon.moveSlots) {\n\t\t\t\t\t\tmoveSlot.disabled = false;\n\t\t\t\t\t\tmoveSlot.disabledSource = '';\n\t\t\t\t\t}\n\t\t\t\t\tthis.runEvent('DisableMove', pokemon);\n\t\t\t\t\tfor (const moveSlot of pokemon.moveSlots) {\n\t\t\t\t\t\tconst activeMove = this.dex.getActiveMove(moveSlot.id);\n\t\t\t\t\t\tthis.singleEvent('DisableMove', activeMove, null, pokemon);\n\t\t\t\t\t\tif (activeMove.flags['cantusetwice'] && pokemon.lastMove?.id === moveSlot.id) {\n\t\t\t\t\t\t\tpokemon.disableMove(pokemon.lastMove.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// If it was an illusion, it's not any more\n\t\t\t\t\tif (pokemon.getLastAttackedBy() && this.gen >= 7) pokemon.knownType = true;\n\n\t\t\t\t\tfor (let i = pokemon.attackedBy.length - 1; i >= 0; i--) {\n\t\t\t\t\t\tconst attack = pokemon.attackedBy[i];\n\t\t\t\t\t\tif (attack.source.isActive) {\n\t\t\t\t\t\t\tattack.thisTurn = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpokemon.attackedBy.splice(pokemon.attackedBy.indexOf(attack), 1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.gen >= 7 && !pokemon.terastallized) {\n\t\t\t\t\t\t// In Gen 7, the real type of every Pokemon is visible to all players via the bottom screen while making choices\n\t\t\t\t\t\tconst seenPokemon = pokemon.illusion || pokemon;\n\t\t\t\t\t\tconst realTypeString = seenPokemon.getTypes(true).join('/');\n\t\t\t\t\t\tif (realTypeString !== seenPokemon.apparentType) {\n\t\t\t\t\t\t\tthis.add('-start', pokemon, 'typechange', realTypeString, '[silent]');\n\t\t\t\t\t\t\tseenPokemon.apparentType = realTypeString;\n\t\t\t\t\t\t\tif (pokemon.addedType) {\n\t\t\t\t\t\t\t\t// The typechange message removes the added type, so put it back\n\t\t\t\t\t\t\t\tthis.add('-start', pokemon, 'typeadd', pokemon.addedType, '[silent]');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tpokemon.trapped = pokemon.maybeTrapped = false;\n\t\t\t\t\tthis.runEvent('TrapPokemon', pokemon);\n\t\t\t\t\tif (!pokemon.knownType || this.dex.getImmunity('trapped', pokemon)) {\n\t\t\t\t\t\tthis.runEvent('MaybeTrapPokemon', pokemon);\n\t\t\t\t\t}\n\t\t\t\t\t// canceling switches would leak information\n\t\t\t\t\t// if a foe might have a trapping ability\n\t\t\t\t\tif (this.gen > 2) {\n\t\t\t\t\t\tfor (const source of pokemon.foes()) {\n\t\t\t\t\t\t\tconst species = (source.illusion || source).species;\n\t\t\t\t\t\t\tif (!species.abilities) continue;\n\t\t\t\t\t\t\tfor (const abilitySlot in species.abilities) {\n\t\t\t\t\t\t\t\tconst abilityName = species.abilities[abilitySlot as keyof Species['abilities']];\n\t\t\t\t\t\t\t\tif (abilityName === source.ability) {\n\t\t\t\t\t\t\t\t\t// pokemon event was already run above so we don't need\n\t\t\t\t\t\t\t\t\t// to run it again.\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst ruleTable = this.ruleTable;\n\t\t\t\t\t\t\t\tif ((ruleTable.has('+hackmons') || !ruleTable.has('obtainableabilities')) && !this.format.team) {\n\t\t\t\t\t\t\t\t\t// hackmons format\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t} else if (abilitySlot === 'H' && species.unreleasedHidden) {\n\t\t\t\t\t\t\t\t\t// unreleased hidden ability\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst ability = this.dex.abilities.get(abilityName);\n\t\t\t\t\t\t\t\tif (ruleTable.has('-ability:' + ability.id)) continue;\n\t\t\t\t\t\t\t\tif (pokemon.knownType && !this.dex.getImmunity('trapped', pokemon)) continue;\n\t\t\t\t\t\t\t\tthis.singleEvent('FoeMaybeTrapPokemon', ability, {}, pokemon, source);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (pokemon.fainted) continue;\n\n\t\t\t\t\tsideTrapped = sideTrapped && pokemon.trapped;\n\t\t\t\t\tconst staleness = pokemon.volatileStaleness || pokemon.staleness;\n\t\t\t\t\tif (staleness) sideStaleness = sideStaleness === 'external' ? sideStaleness : staleness;\n\t\t\t\t\tpokemon.activeTurns++;\n\t\t\t\t}\n\t\t\t\ttrappedBySide.push(sideTrapped);\n\t\t\t\tstalenessBySide.push(sideStaleness);\n\t\t\t\tside.faintedLastTurn = side.faintedThisTurn;\n\t\t\t\tside.faintedThisTurn = null;\n\t\t\t}\n\n\t\t\tif (this.maybeTriggerEndlessBattleClause(trappedBySide, stalenessBySide)) return;\n\n\t\t\tif (this.gameType === 'triples' && this.sides.every(side => side.pokemonLeft === 1)) {\n\t\t\t\t// If both sides have one Pokemon left in triples and they are not adjacent, they are both moved to the center.\n\t\t\t\tconst actives = this.getAllActive();\n\t\t\t\tif (actives.length > 1 && !actives[0].isAdjacent(actives[1])) {\n\t\t\t\t\tthis.swapPosition(actives[0], 1, '[silent]');\n\t\t\t\t\tthis.swapPosition(actives[1], 1, '[silent]');\n\t\t\t\t\tthis.add('-center');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.add('turn', this.turn);\n\t\t\tif (this.gameType === 'multi') {\n\t\t\t\tfor (const side of this.sides) {\n\t\t\t\t\tif (side.canDynamaxNow()) {\n\t\t\t\t\t\tif (this.turn === 1) {\n\t\t\t\t\t\t\tthis.addSplit(side.id, ['-candynamax', side.id]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.add('-candynamax', side.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.gen === 2) this.quickClawRoll = this.randomChance(60, 256);\n\t\t\tif (this.gen === 3) this.quickClawRoll = this.randomChance(1, 5);\n\n\t\t\t// Crazyhouse Progress checker because sidebars has trouble keeping track of Pokemon.\n\t\t\t// Please remove me once there is client support.\n\t\t\tif (this.ruleTable.has('crazyhouserule')) {\n\t\t\t\tfor (const side of this.sides) {\n\t\t\t\t\tlet buf = `raw|${Utils.escapeHTML(side.name)}'s team:<br />`;\n\t\t\t\t\tfor (const pokemon of side.pokemon) {\n\t\t\t\t\t\tif (!buf.endsWith('<br />')) buf += '/</span>&#8203;';\n\t\t\t\t\t\tif (pokemon.fainted) {\n\t\t\t\t\t\t\tbuf += `<span style=\"white-space:nowrap;\"><span style=\"opacity:.3\"><psicon pokemon=\"${pokemon.species.id}\" /></span>`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbuf += `<span style=\"white-space:nowrap\"><psicon pokemon=\"${pokemon.species.id}\" />`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.add(`${buf}</span>`);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.makeRequest('move');\n\t\t},\n\t\trunAction(action: Action) {\n\t\t\tconst pokemonOriginalHP = action.pokemon?.hp;\n\t\t\tlet residualPokemon: (readonly [Pokemon, number])[] = [];\n\t\t\t// returns whether or not we ended in a callback\n\t\t\tswitch (action.choice) {\n\t\t\tcase 'start': {\n\t\t\t\tfor (const side of this.sides) {\n\t\t\t\t\tif (side.pokemonLeft) side.pokemonLeft = side.pokemon.length;\n\t\t\t\t}\n\n\t\t\t\tthis.add('start');\n\n\t\t\t\t// Change Zacian/Zamazenta into their Crowned formes\n\t\t\t\tfor (const pokemon of this.getAllPokemon()) {\n\t\t\t\t\tlet rawSpecies: Species | null = null;\n\t\t\t\t\tconsole.log(pokemon.species.id + \" \" + pokemon.item);\n\t\t\t\t\tif (pokemon.species.id === 'cirno' && pokemon.item === 'summerbackdoor') {\n\t\t\t\t\t\trawSpecies = this.dex.species.get('Cirno-Tanned');\n\t\t\t\t\t} else if (pokemon.species.id === 'zamazenta' && pokemon.item === 'rustedshield') {\n\t\t\t\t\t\trawSpecies = this.dex.species.get('Zamazenta-Crowned');\n\t\t\t\t\t}\n\t\t\t\t\tif (!rawSpecies) continue;\n\t\t\t\t\tconst species = pokemon.setSpecies(rawSpecies);\n\t\t\t\t\tif (!species) continue;\n\t\t\t\t\tpokemon.baseSpecies = rawSpecies;\n\t\t\t\t\tpokemon.details = species.name + (pokemon.level === 100 ? '' : ', L' + pokemon.level) +\n\t\t\t\t\t\t(pokemon.gender === '' ? '' : ', ' + pokemon.gender) + (pokemon.set.shiny ? ', shiny' : '');\n\t\t\t\t\tpokemon.setAbility(species.abilities['0'], null, true);\n\t\t\t\t\tpokemon.baseAbility = pokemon.ability;\n\n\t\t\t\t\tconst behemothMove: {[k: string]: string} = {\n\t\t\t\t\t\t'Zacian-Crowned': 'behemothblade', 'Zamazenta-Crowned': 'behemothbash',\n\t\t\t\t\t};\n\t\t\t\t\tconst ironHead = pokemon.baseMoves.indexOf('ironhead');\n\t\t\t\t\tif (ironHead >= 0) {\n\t\t\t\t\t\tconst move = this.dex.moves.get(behemothMove[rawSpecies.name]);\n\t\t\t\t\t\tpokemon.baseMoveSlots[ironHead] = {\n\t\t\t\t\t\t\tmove: move.name,\n\t\t\t\t\t\t\tid: move.id,\n\t\t\t\t\t\t\tpp: (move.noPPBoosts || move.isZ) ? move.pp : move.pp * 8 / 5,\n\t\t\t\t\t\t\tmaxpp: (move.noPPBoosts || move.isZ) ? move.pp : move.pp * 8 / 5,\n\t\t\t\t\t\t\ttarget: move.target,\n\t\t\t\t\t\t\tdisabled: false,\n\t\t\t\t\t\t\tdisabledSource: '',\n\t\t\t\t\t\t\tused: false,\n\t\t\t\t\t\t};\n\t\t\t\t\t\tpokemon.moveSlots = pokemon.baseMoveSlots.slice();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (this.format.onBattleStart) this.format.onBattleStart.call(this);\n\t\t\t\tfor (const rule of this.ruleTable.keys()) {\n\t\t\t\t\tif ('+*-!'.includes(rule.charAt(0))) continue;\n\t\t\t\t\tconst subFormat = this.dex.formats.get(rule);\n\t\t\t\t\tif (subFormat.onBattleStart) subFormat.onBattleStart.call(this);\n\t\t\t\t}\n\n\t\t\t\tfor (const side of this.sides) {\n\t\t\t\t\tfor (let i = 0; i < side.active.length; i++) {\n\t\t\t\t\t\tif (!side.pokemonLeft) {\n\t\t\t\t\t\t\t// forfeited before starting\n\t\t\t\t\t\t\tside.active[i] = side.pokemon[i];\n\t\t\t\t\t\t\tside.active[i].fainted = true;\n\t\t\t\t\t\t\tside.active[i].hp = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.actions.switchIn(side.pokemon[i], i);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const pokemon of this.getAllPokemon()) {\n\t\t\t\t\tthis.singleEvent('Start', this.dex.conditions.getByID(pokemon.species.id), pokemon.speciesState, pokemon);\n\t\t\t\t}\n\t\t\t\tthis.midTurn = true;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'move':\n\t\t\t\tif (!action.pokemon.isActive) return false;\n\t\t\t\tif (action.pokemon.fainted) return false;\n\t\t\t\tthis.actions.runMove(action.move, action.pokemon, action.targetLoc, action.sourceEffect,\n\t\t\t\t\taction.zmove, undefined, action.maxMove, action.originalTarget);\n\t\t\t\tbreak;\n\t\t\tcase 'megaEvo':\n\t\t\t\tthis.actions.runMegaEvo(action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'megaEvoX':\n\t\t\t\tthis.actions.runMegaEvoX?.(action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'megaEvoY':\n\t\t\t\tthis.actions.runMegaEvoY?.(action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'runDynamax':\n\t\t\t\tconsole.log(action.pokemon.baseSpecies.name + action.pokemon.baseSpecies.canDynamax);\n\t\t\t\tif (action.pokemon.baseSpecies.canDynamax) action.pokemon.addVolatile('dynamax');\n\t\t\t\taction.pokemon.side.dynamaxUsed = true;\n\t\t\t\tif (action.pokemon.side.allySide) action.pokemon.side.allySide.dynamaxUsed = true;\n\t\t\t\tbreak;\n\t\t\tcase 'terastallize':\n\t\t\t\tthis.actions.terastallize(action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'beforeTurnMove':\n\t\t\t\tif (!action.pokemon.isActive) return false;\n\t\t\t\tif (action.pokemon.fainted) return false;\n\t\t\t\tthis.debug('before turn callback: ' + action.move.id);\n\t\t\t\tconst target = this.getTarget(action.pokemon, action.move, action.targetLoc);\n\t\t\t\tif (!target) return false;\n\t\t\t\tif (!action.move.beforeTurnCallback) throw new Error(`beforeTurnMove has no beforeTurnCallback`);\n\t\t\t\taction.move.beforeTurnCallback.call(this, action.pokemon, target);\n\t\t\t\tbreak;\n\t\t\tcase 'priorityChargeMove':\n\t\t\t\tif (!action.pokemon.isActive) return false;\n\t\t\t\tif (action.pokemon.fainted) return false;\n\t\t\t\tthis.debug('priority charge callback: ' + action.move.id);\n\t\t\t\tif (!action.move.priorityChargeCallback) throw new Error(`priorityChargeMove has no priorityChargeCallback`);\n\t\t\t\taction.move.priorityChargeCallback.call(this, action.pokemon);\n\t\t\t\tbreak;\n\n\t\t\tcase 'event':\n\t\t\t\tthis.runEvent(action.event!, action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'team':\n\t\t\t\tif (action.index === 0) {\n\t\t\t\t\taction.pokemon.side.pokemon = [];\n\t\t\t\t}\n\t\t\t\taction.pokemon.side.pokemon.push(action.pokemon);\n\t\t\t\taction.pokemon.position = action.index;\n\t\t\t\t// we return here because the update event would crash since there are no active pokemon yet\n\t\t\t\treturn;\n\n\t\t\tcase 'pass':\n\t\t\t\treturn;\n\t\t\tcase 'instaswitch':\n\t\t\tcase 'switch':\n\t\t\t\tif (action.choice === 'switch' && action.pokemon.status) {\n\t\t\t\t\tthis.singleEvent('CheckShow', this.dex.abilities.getByID('naturalcure' as ID), null, action.pokemon);\n\t\t\t\t}\n\t\t\t\tif (this.actions.switchIn(action.target, action.pokemon.position, action.sourceEffect) === 'pursuitfaint') {\n\t\t\t\t\t// a pokemon fainted from Pursuit before it could switch\n\t\t\t\t\tif (this.gen <= 4) {\n\t\t\t\t\t\t// in gen 2-4, the switch still happens\n\t\t\t\t\t\tthis.hint(\"Previously chosen switches continue in Gen 2-4 after a Pursuit target faints.\");\n\t\t\t\t\t\taction.priority = -101;\n\t\t\t\t\t\tthis.queue.unshift(action);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// in gen 5+, the switch is cancelled\n\t\t\t\t\t\tthis.hint(\"A Pokemon can't switch between when it runs out of HP and when it faints\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'revivalblessing':\n\t\t\t\taction.pokemon.side.pokemonLeft++;\n\t\t\t\tif (action.target.position < action.pokemon.side.active.length) {\n\t\t\t\t\tthis.queue.addChoice({\n\t\t\t\t\t\tchoice: 'instaswitch',\n\t\t\t\t\t\tpokemon: action.target,\n\t\t\t\t\t\ttarget: action.target,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\taction.target.fainted = false;\n\t\t\t\taction.target.faintQueued = false;\n\t\t\t\taction.target.subFainted = false;\n\t\t\t\taction.target.status = '';\n\t\t\t\taction.target.hp = 1; // Needed so hp functions works\n\t\t\t\taction.target.sethp(action.target.maxhp / 2);\n\t\t\t\tthis.add('-heal', action.target, action.target.getHealth, '[from] move: Revival Blessing');\n\t\t\t\taction.pokemon.side.removeSlotCondition(action.pokemon, 'revivalblessing');\n\t\t\t\tbreak;\n\t\t\tcase 'runUnnerve':\n\t\t\t\tthis.singleEvent('PreStart', action.pokemon.getAbility(), action.pokemon.abilityState, action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'runSwitch':\n\t\t\t\tthis.actions.runSwitch(action.pokemon);\n\t\t\t\tbreak;\n\t\t\tcase 'runPrimal':\n\t\t\t\tif (!action.pokemon.transformed) {\n\t\t\t\t\tthis.singleEvent('Primal', action.pokemon.getItem(), action.pokemon.itemState, action.pokemon);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'shift':\n\t\t\t\tif (!action.pokemon.isActive) return false;\n\t\t\t\tif (action.pokemon.fainted) return false;\n\t\t\t\tthis.swapPosition(action.pokemon, 1);\n\t\t\t\tbreak;\n\n\t\t\tcase 'beforeTurn':\n\t\t\t\tthis.eachEvent('BeforeTurn');\n\t\t\t\tbreak;\n\t\t\tcase 'residual':\n\t\t\t\tthis.add('');\n\t\t\t\tthis.clearActiveMove(true);\n\t\t\t\tthis.updateSpeed();\n\t\t\t\tresidualPokemon = this.getAllActive().map(pokemon => [pokemon, pokemon.getUndynamaxedHP()] as const);\n\t\t\t\tthis.residualEvent('Residual');\n\t\t\t\tthis.add('upkeep');\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// phazing (Roar, etc)\n\t\t\tfor (const side of this.sides) {\n\t\t\t\tfor (const pokemon of side.active) {\n\t\t\t\t\tif (pokemon.forceSwitchFlag) {\n\t\t\t\t\t\tif (pokemon.hp) this.actions.dragIn(pokemon.side, pokemon.position);\n\t\t\t\t\t\tpokemon.forceSwitchFlag = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.clearActiveMove();\n\n\t\t\t// fainting\n\n\t\t\tthis.faintMessages();\n\t\t\tif (this.ended) return true;\n\n\t\t\t// switching (fainted pokemon, U-turn, Baton Pass, etc)\n\n\t\t\tif (!this.queue.peek() || (this.gen <= 3 && ['move', 'residual'].includes(this.queue.peek()!.choice))) {\n\t\t\t\t// in gen 3 or earlier, switching in fainted pokemon is done after\n\t\t\t\t// every move, rather than only at the end of the turn.\n\t\t\t\tthis.checkFainted();\n\t\t\t} else if (['megaEvo', 'megaEvoX', 'megaEvoY'].includes(action.choice) && this.gen === 7) {\n\t\t\t\tthis.eachEvent('Update');\n\t\t\t\t// In Gen 7, the action order is recalculated for a Pok\u00E9mon that mega evolves.\n\t\t\t\tfor (const [i, queuedAction] of this.queue.list.entries()) {\n\t\t\t\t\tif (queuedAction.pokemon === action.pokemon && queuedAction.choice === 'move') {\n\t\t\t\t\t\tthis.queue.list.splice(i, 1);\n\t\t\t\t\t\tqueuedAction.mega = 'done';\n\t\t\t\t\t\tthis.queue.insertChoice(queuedAction, true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} else if (this.queue.peek()?.choice === 'instaswitch') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this.gen >= 5) {\n\t\t\t\tthis.eachEvent('Update');\n\t\t\t\tfor (const [pokemon, originalHP] of residualPokemon) {\n\t\t\t\t\tconst maxhp = pokemon.getUndynamaxedHP(pokemon.maxhp);\n\t\t\t\t\tif (pokemon.hp && pokemon.getUndynamaxedHP() <= maxhp / 2 && originalHP > maxhp / 2) {\n\t\t\t\t\t\tthis.runEvent('EmergencyExit', pokemon);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (action.choice === 'runSwitch') {\n\t\t\t\tconst pokemon = action.pokemon;\n\t\t\t\tif (pokemon.hp && pokemon.hp <= pokemon.maxhp / 2 && pokemonOriginalHP! > pokemon.maxhp / 2) {\n\t\t\t\t\tthis.runEvent('EmergencyExit', pokemon);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst switches = this.sides.map(\n\t\t\t\tside => side.active.some(pokemon => pokemon && !!pokemon.switchFlag)\n\t\t\t);\n\n\t\t\tfor (let i = 0; i < this.sides.length; i++) {\n\t\t\t\tlet reviveSwitch = false; // Used to ignore the fake switch for Revival Blessing\n\t\t\t\tif (switches[i] && !this.canSwitch(this.sides[i])) {\n\t\t\t\t\tfor (const pokemon of this.sides[i].active) {\n\t\t\t\t\t\tif (this.sides[i].slotConditions[pokemon.position]['revivalblessing']) {\n\t\t\t\t\t\t\treviveSwitch = true;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpokemon.switchFlag = false;\n\t\t\t\t\t}\n\t\t\t\t\tif (!reviveSwitch) switches[i] = false;\n\t\t\t\t} else if (switches[i]) {\n\t\t\t\t\tfor (const pokemon of this.sides[i].active) {\n\t\t\t\t\t\tif (pokemon.hp && pokemon.switchFlag && pokemon.switchFlag !== 'revivalblessing' &&\n\t\t\t\t\t\t\t\t!pokemon.skipBeforeSwitchOutEventFlag) {\n\t\t\t\t\t\t\tthis.runEvent('BeforeSwitchOut', pokemon);\n\t\t\t\t\t\t\tpokemon.skipBeforeSwitchOutEventFlag = true;\n\t\t\t\t\t\t\tthis.faintMessages(); // Pokemon may have fainted in BeforeSwitchOut\n\t\t\t\t\t\t\tif (this.ended) return true;\n\t\t\t\t\t\t\tif (pokemon.fainted) {\n\t\t\t\t\t\t\t\tswitches[i] = this.sides[i].active.some(sidePokemon => sidePokemon && !!sidePokemon.switchFlag);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const playerSwitch of switches) {\n\t\t\t\tif (playerSwitch) {\n\t\t\t\t\tthis.makeRequest('switch');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.gen < 5) this.eachEvent('Update');\n\n\t\t\tif (this.gen >= 8 && (this.queue.peek()?.choice === 'move' || this.queue.peek()?.choice === 'runDynamax')) {\n\t\t\t\t// In gen 8, speed is updated dynamically so update the queue's speed properties and sort it.\n\t\t\t\tthis.updateSpeed();\n\t\t\t\tfor (const queueAction of this.queue.list) {\n\t\t\t\t\tif (queueAction.pokemon) this.getActionSpeed(queueAction);\n\t\t\t\t}\n\t\t\t\tthis.queue.sort();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t},\n\tpokemon: {\n\t\thasAbility(ability) {\n\t\t\tif (this.ignoringAbility()) return false;\n\t\t\tif (Array.isArray(ability)) return ability.some(abil => this.hasAbility(abil));\n\t\t\tconst abilityid = this.battle.toID(ability);\n\t\t\treturn this.ability === abilityid || !!this.volatiles['ability:' + abilityid];\n\t\t},\n\t\tcanDynamax() {\n\t\t\treturn this.hasAbility('growbigger') && !this.hasDynamaxed;\n\t\t},\n\t\teffectiveWeather() {\n\t\t\tif (this.hasAbility('lunatictorch') && this.battle.field.isTerrain('psychicterrain')) return 'sunnyday';\n\t\t\tconst weather = this.battle.field.effectiveWeather();\n\t\t\tswitch (weather) {\n\t\t\tcase 'sunnyday':\n\t\t\tcase 'desolateland':\n\t\t\t\tif (this.hasAbility('shadowshroud')) return '';\n\t\t\tcase 'raindance':\n\t\t\tcase 'primordialsea':\n\t\t\t\tif (this.hasItem('utilityumbrella')) return '';\n\t\t\t}\n\t\t\treturn weather;\n\t\t},\n\t\tsetType(newType: string | string[], enforce = false) {\n\t\t\tif (!enforce) {\n\t\t\t\t// No Pokemon should be able to have Stellar as a base type\n\t\t\t\tif (typeof newType === 'string' ? newType === 'Stellar' : newType.includes('Stellar')) return false;\n\t\t\t\t// First type of Arceus, Silvally cannot be normally changed\n\t\t\t\tif (this.species.num === 104) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Terastallized Pokemon cannot have their base type changed except via forme change\n\t\t\t\tif (this.terastallized) return false;\n\t\t\t}\n\n\t\t\tif (!newType) throw new Error(\"Must pass type to setType\");\n\t\t\tthis.types = (typeof newType === 'string' ? [newType] : newType);\n\t\t\tthis.addedType = '';\n\t\t\tthis.knownType = true;\n\t\t\tthis.apparentType = this.types.join('/');\n\n\t\t\treturn true;\n\t\t}\n\t},\n\tactions: {\n\t\trunMove(\n\t\tmoveOrMoveName: Move | string, pokemon: Pokemon, targetLoc: number, sourceEffect?: Effect | null,\n\t\tzMove?: string, externalMove?: boolean, maxMove?: string, originalTarget?: Pokemon\n\t\t) {\n\t\t\tpokemon.activeMoveActions++;\n\t\t\tlet target = this.battle.getTarget(pokemon, maxMove || zMove || moveOrMoveName, targetLoc, originalTarget);\n\t\t\tlet baseMove = this.dex.getActiveMove(moveOrMoveName);\n\t\t\tconst pranksterBoosted = baseMove.pranksterBoosted;\n\t\t\tif (baseMove.id !== 'struggle' && !zMove && !maxMove && !externalMove) {\n\t\t\t\tconst changedMove = this.battle.runEvent('OverrideAction', pokemon, target, baseMove);\n\t\t\t\tif (changedMove && changedMove !== true) {\n\t\t\t\t\tbaseMove = this.dex.getActiveMove(changedMove);\n\t\t\t\t\tif (pranksterBoosted) baseMove.pranksterBoosted = pranksterBoosted;\n\t\t\t\t\ttarget = this.battle.getRandomTarget(pokemon, baseMove);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet move = baseMove;\n\t\t\tif (zMove) {\n\t\t\t\tmove = this.getActiveZMove(baseMove, pokemon);\n\t\t\t} else if (maxMove) {\n\t\t\t\tmove = this.getActiveMaxMove(baseMove, pokemon);\n\t\t\t}\n\n\t\t\tmove.isExternal = externalMove;\n\n\t\t\tthis.battle.setActiveMove(move, pokemon, target);\n\n\t\t\t/* if (pokemon.moveThisTurn) {\n\t\t\t\t// THIS IS PURELY A SANITY CHECK\n\t\t\t\t// DO NOT TAKE ADVANTAGE OF THIS TO PREVENT A POKEMON FROM MOVING;\n\t\t\t\t// USE this.queue.cancelMove INSTEAD\n\t\t\t\tthis.battle.debug('' + pokemon.id + ' INCONSISTENT STATE, ALREADY MOVED: ' + pokemon.moveThisTurn);\n\t\t\t\tthis.battle.clearActiveMove(true);\n\t\t\t\treturn;\n\t\t\t} */\n\t\t\tconst willTryMove = this.battle.runEvent('BeforeMove', pokemon, target, move);\n\t\t\tif (!willTryMove) {\n\t\t\t\tthis.battle.runEvent('MoveAborted', pokemon, target, move);\n\t\t\t\tthis.battle.clearActiveMove(true);\n\t\t\t\t// The event 'BeforeMove' could have returned false or null\n\t\t\t\t// false indicates that this counts as a move failing for the purpose of calculating Stomping Tantrum's base power\n\t\t\t\t// null indicates the opposite, as the Pokemon didn't have an option to choose anything\n\t\t\t\tpokemon.moveThisTurnResult = willTryMove;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Used exclusively for a hint later\n\t\t\tif (move.flags['cantusetwice'] && pokemon.lastMove?.id === move.id) {\n\t\t\t\tpokemon.addVolatile(move.id);\n\t\t\t}\n\n\t\t\tif (move.beforeMoveCallback) {\n\t\t\t\tif (move.beforeMoveCallback.call(this.battle, pokemon, target, move)) {\n\t\t\t\t\tthis.battle.clearActiveMove(true);\n\t\t\t\t\tpokemon.moveThisTurnResult = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpokemon.lastDamage = 0;\n\t\t\tlet lockedMove;\n\t\t\tif (!externalMove) {\n\t\t\t\tlockedMove = this.battle.runEvent('LockMove', pokemon);\n\t\t\t\tif (lockedMove === true) lockedMove = false;\n\t\t\t\tif (!lockedMove) {\n\t\t\t\t\tif (!pokemon.deductPP(baseMove, null, target) && (move.id !== 'struggle')) {\n\t\t\t\t\t\tthis.battle.add('cant', pokemon, 'nopp', move);\n\t\t\t\t\t\tthis.battle.clearActiveMove(true);\n\t\t\t\t\t\tpokemon.moveThisTurnResult = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsourceEffect = this.dex.conditions.get('lockedmove');\n\t\t\t\t}\n\t\t\t\tpokemon.moveUsed(move, targetLoc);\n\t\t\t}\n\n\t\t\t// Dancer Petal Dance hack\n\t\t\t// TODO: implement properly\n\t\t\tconst noLock = externalMove && !pokemon.volatiles['lockedmove'];\n\n\t\t\tif (zMove) {\n\t\t\t\tif (pokemon.illusion) {\n\t\t\t\t\tthis.battle.singleEvent('End', this.dex.abilities.get('Illusion'), pokemon.abilityState, pokemon);\n\t\t\t\t}\n\t\t\t\tthis.battle.add('-zpower', pokemon);\n\t\t\t\tpokemon.side.zMoveUsed = true;\n\t\t\t}\n\n\t\t\tconst oldActiveMove = move;\n\n\t\t\tconst moveDidSomething = this.useMove(baseMove, pokemon, target, sourceEffect, zMove, maxMove);\n\t\t\tthis.battle.lastSuccessfulMoveThisTurn = moveDidSomething ? this.battle.activeMove && this.battle.activeMove.id : null;\n\t\t\tif (this.battle.activeMove) move = this.battle.activeMove;\n\t\t\tthis.battle.singleEvent('AfterMove', move, null, pokemon, target, move);\n\t\t\tthis.battle.runEvent('AfterMove', pokemon, target, move);\n\t\t\tif (move.flags['cantusetwice'] && pokemon.removeVolatile(move.id)) {\n\t\t\t\tthis.battle.add('-hint', `Some effects can force a Pokemon to use ${move.name} again in a row.`);\n\t\t\t}\n\n\t\t\t// Dancer's activation order is completely different from any other event, so it's handled separately\n\t\t\tif (move.flags['sound'] && !move.isExternal) {\n\t\t\t\tconst sounders = [];\n\t\t\t\tfor (const currentPoke of this.battle.getAllActive()) {\n\t\t\t\t\tif (pokemon === currentPoke) continue;\n\t\t\t\t\tif (currentPoke.hasAbility('echo') && !currentPoke.isSemiInvulnerable()) {\n\t\t\t\t\t\tsounders.push(currentPoke);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Dancer activates in order of lowest speed stat to highest\n\t\t\t\t// Note that the speed stat used is after any volatile replacements like Speed Swap,\n\t\t\t\t// but before any multipliers like Agility or Choice Scarf\n\t\t\t\t// Ties go to whichever Pokemon has had the ability for the least amount of time\n\t\t\t\tsounders.sort(\n\t\t\t\t\t(a, b) => -(b.storedStats['spe'] - a.storedStats['spe']) || b.abilityOrder - a.abilityOrder\n\t\t\t\t);\n\t\t\t\tconst targetOf1stSound = this.battle.activeTarget!;\n\t\t\t\tfor (const sounder of sounders) {\n\t\t\t\t\tif (this.battle.faintMessages()) break;\n\t\t\t\t\tif (sounder.fainted) continue;\n\t\t\t\t\tthis.battle.add('-activate', sounder, 'ability: Echo');\n\t\t\t\t\tconst soundersTarget = !targetOf1stSound.isAlly(sounder) && pokemon.isAlly(sounder) ?\n\t\t\t\t\t\ttargetOf1stSound :\n\t\t\t\t\t\tpokemon;\n\t\t\t\t\tconst soundersTargetLoc = sounder.getLocOf(soundersTarget);\n\t\t\t\t\tthis.runMove(move.id, sounder, soundersTargetLoc, this.dex.abilities.get('echo'), undefined, true);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (noLock && pokemon.volatiles['lockedmove']) delete pokemon.volatiles['lockedmove'];\n\t\t\tthis.battle.faintMessages();\n\t\t\tthis.battle.checkWin();\n\n\t\t\tif (this.battle.gen <= 4) {\n\t\t\t\t// In gen 4, the outermost move is considered the last move for Copycat\n\t\t\t\tthis.battle.activeMove = oldActiveMove;\n\t\t\t}\n\t\t}\n\t},\n\tside: {\n\t\tconstructor(name: string, battle: Battle, sideNum: number, team: PokemonSet[]) {\n\t\t\tconst sideScripts = battle.dex.data.Scripts.side;\n\t\t\tif (sideScripts) Object.assign(this, sideScripts);\n\n\t\t\tthis.battle = battle;\n\t\t\tthis.id = ['p1', 'p2', 'p3', 'p4'][sideNum] as SideID;\n\t\t\tthis.n = sideNum;\n\n\t\t\tthis.name = name;\n\t\t\tthis.avatar = '';\n\n\t\t\tthis.team = team;\n\t\t\tthis.pokemon = [];\n\t\t\tfor (const set of this.team) {\n\t\t\t\t// console.log(\"NEW POKEMON: \" + (this.team[i] ? this.team[i].name : '[unidentified]'));\n\t\t\t\tthis.addPokemon(set);\n\t\t\t}\n\n\t\t\tswitch (this.battle.gameType) {\n\t\t\tcase 'doubles':\n\t\t\t\tthis.active = [null!, null!];\n\t\t\t\tbreak;\n\t\t\tcase 'triples': case 'rotation':\n\t\t\t\tthis.active = [null!, null!, null!];\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthis.active = [null!];\n\t\t\t}\n\n\t\t\tthis.pokemonLeft = this.pokemon.length;\n\t\t\tthis.faintedLastTurn = null;\n\t\t\tthis.faintedThisTurn = null;\n\t\t\tthis.totalFainted = 0;\n\t\t\tthis.zMoveUsed = false;\n\t\t\tthis.dynamaxUsed = false;\n\n\t\t\tthis.sideConditions = {};\n\t\t\tthis.slotConditions = [];\n\t\t\t// Array#fill doesn't work for this\n\t\t\tfor (let i = 0; i < this.active.length; i++) this.slotConditions[i] = {};\n\n\t\t\tthis.activeRequest = null;\n\t\t\tthis.choice = {\n\t\t\t\tcantUndo: false,\n\t\t\t\terror: ``,\n\t\t\t\tactions: [],\n\t\t\t\tforcedSwitchesLeft: 0,\n\t\t\t\tforcedPassesLeft: 0,\n\t\t\t\tswitchIns: new Set(),\n\t\t\t\tzMove: false,\n\t\t\t\tmega: false,\n\t\t\t\tultra: false,\n\t\t\t\tdynamax: false,\n\t\t\t\tterastallize: false,\n\t\t\t};\n\n\t\t\t// old-gens\n\t\t\tthis.lastMove = null;\n\t\t},\n\t\tcanDynamaxNow(): boolean {\n\t\t\t// In multi battles, players on a team are alternatingly given the option to dynamax each turn\n\t\t\t// On turn 1, the players on their team's respective left have the first chance (p1 and p2)\n\t\t\tif (this.battle.gameType === 'multi' && this.battle.turn % 2 !== [1, 1, 0, 0][this.n]) return false;\n\t\t\t// if (this.battle.gameType === 'multitriples' && this.battle.turn % 3 !== [1, 1, 2, 2, 0, 0][this.side.n]) {\n\t\t\t//\t\treturn false;\n\t\t\t// }\n\t\t\tlet can = false;\n\t\t\tfor (const pokemon of this.active) {\n\t\t\t\tif (pokemon && pokemon.hp && pokemon.canDynamax()) can = true;\n\t\t\t}\n\t\t\treturn can;\n\t\t}\n\t},\n};"],
  "mappings": "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",
  "names": []
}
