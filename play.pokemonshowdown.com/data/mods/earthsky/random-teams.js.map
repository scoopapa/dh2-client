{
  "version": 3,
  "sources": ["../../../../data/mods/earthsky/random-teams.ts"],
  "sourcesContent": ["import {Dex, toID} from '../../../sim/dex';\nimport {Utils} from '../../../lib';\nimport {PRNG, PRNGSeed} from '../../../sim/prng';\nimport {RuleTable} from '../../../sim/dex-formats';\nimport {Tags} from './tags';\n\nexport interface TeamData {\n\ttypeCount: {[k: string]: number};\n\ttypeComboCount: {[k: string]: number};\n\tbaseFormes: {[k: string]: number};\n\tmegaCount?: number;\n\thas: {[k: string]: number};\n\tforceResult: boolean;\n\tweaknesses: {[k: string]: number};\n\tresistances: {[k: string]: number};\n\tweather?: string;\n\titemList: string[];\n}\nexport interface BattleFactorySpecies {\n\tflags: {limEevee?: 1};\n\tsets: BattleFactorySet[];\n}\ninterface BattleFactorySet {\n\tspecies: string;\n\titem: string;\n\tability: string;\n\tnature: string;\n\tmoves: string[];\n\tevs?: Partial<StatsTable>;\n\tivs?: Partial<StatsTable>;\n}\nexport class MoveCounter extends Utils.Multiset<string> {\n\tdamagingMoves: Set<Move>;\n\tironFist: number;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.damagingMoves = new Set();\n\t\tthis.ironFist = 0;\n\t}\n\n\tget(key: string): number {\n\t\treturn super.get(key) || 0;\n\t}\n}\n\ntype MoveEnforcementChecker = (\n\tmovePool: string[], moves: Set<string>, abilities: Set<string>, types: string[],\n\tcounter: MoveCounter, species: Species, teamDetails: RandomTeamsTypes.TeamDetails,\n\tisLead: boolean, isDoubles: boolean, role: RandomTeamsTypes.Role,\n) => boolean;\n\n// Moves that restore HP:\nconst RECOVERY_MOVES = [\n\t'healorder', 'milkdrink', 'moonlight', 'morningsun', 'recover', 'rejuvenate', 'roost', 'shoreup', 'slackoff', 'softboiled', 'strengthsap', 'synthesis',\n];\n// Moves that drop stats:\nconst CONTRARY_MOVES = [\n\t'armorcannon', 'closecombat', 'leafstorm', 'overheat', 'spinout', 'superpower', 'vcreate',\n];\n// Moves that boost Attack:\nconst PHYSICAL_SETUP = [\n\t'bellydrum', 'bulkup', 'coil', 'curse', 'dragondance', 'honeclaws', 'howl', 'meditate', 'poweruppunch', 'sharpen', 'swordsdance', 'victorydance',\n];\n// Moves which boost Special Attack:\nconst SPECIAL_SETUP = [\n\t'calmmind', 'chargebeam', 'geomancy', 'nastyplot', 'quiverdance', 'tailglow', 'torchsong',\n];\n// Moves that boost Attack AND Special Attack:\nconst MIXED_SETUP = [\n\t'eminence', 'growth', 'noretreat', 'shellsmash', 'workup', 'warriorssoul',\n];\n// Some moves that only boost Speed:\nconst SPEED_SETUP = [\n\t'agility', 'autotomize', 'flamecharge', 'rockpolish', 'trailhead',\n];\n// Conglomerate for ease of access\nconst SETUP = [\n\t'acidarmor', 'agility', 'autotomize', 'bellydrum', 'bulkup', 'calmmind', 'coil', 'cosmicpower', 'curse',\n\t'dragondance', 'eminence', 'flamecharge', 'growth', 'honeclaws', 'howl', 'irondefense', 'meditate', 'nastyplot', 'noretreat', 'poweruppunch',\n\t'quiverdance', 'rockpolish', 'shellsmash', 'shelter', 'shiftgear', 'swordsdance', 'tailglow', 'trailhead', 'victorydance', 'warriorssoul', 'workup',\n];\nconst SPEED_CONTROL = [\n\t'electroweb', 'glaciate', 'glare', 'icywind', 'lowsweep', 'quash', 'rocktomb', 'stringshot', 'tailwind', 'thunderwave', 'trickroom',\n];\n// Moves that shouldn't be the only STAB moves:\nconst NO_STAB = [\n\t'accelerock', 'aerate', 'aquajet', 'bounce', 'breakingswipe', 'bulletpunch', 'chatter', 'chloroblast', 'clearsmog', 'covet',\n\t'dragontail', 'doomdesire', 'electroweb', 'eruption', 'explosion', 'fakeout', 'feint', 'flamecharge', 'futuresight',\n\t'iceshard', 'icywind', 'incinerate', 'infestation', 'machpunch', 'meteorbeam', 'nuzzle', 'pelletshot', 'pluck', 'pursuit',\n\t'quickattack', 'rapidspin', 'reversal', 'selfdestruct', 'shadowsneak', 'skydrop', 'snarl', 'strugglebug', 'suckerpunch', 'uturn',\n\t'vacuumwave', 'voltswitch', 'watershuriken', 'waterspout',\n];\n// Hazard-setting moves\nconst HAZARDS = [\n\t'spikes', 'stealthrock', 'stickyweb', 'toxicspikes',\n];\n// Protect and its variants\nconst PROTECT_MOVES = [\n\t'bunkerdown', 'kingsshield', 'obstruct', 'protect', 'silktrap', 'spikyshield',\n];\n// Moves that switch the user out\nconst PIVOT_MOVES = [\n\t'escapetunnel', 'partingshot', 'psybubble', 'slipaway', 'teleport', 'uturn', 'voltswitch',\n];\n\n// Moves that should be paired together when possible\nconst MOVE_PAIRS = [\n\t['lightscreen', 'reflect'],\n\t['sleeptalk', 'rest'],\n\t['protect', 'wish'],\n\t['leechseed', 'protect'],\n\t['leechseed', 'substitute'],\n\t['bodypress', 'irondefense'],\n\t['bodypress', 'flowershield'],\n];\n\n/** Pokemon who always want priority STAB, and are fine with it as its only STAB move of that type */\nconst PRIORITY_POKEMON = [\n\t'aegislashblade', 'banette', 'breloom', 'brutebonnet', 'cacturne', 'doublade', 'golisopod', 'honchkrow', 'mimikyu', 'scizor', 'scizormega', 'shedinja',\n];\n\n/** Pokemon who should never be in the lead slot */\nconst NO_LEAD_POKEMON = [\n\t'Ogerpon', 'Power Chassis', 'Slither Wing', 'Zacian', 'Zamazenta',\n];\nconst DOUBLES_NO_LEAD_POKEMON = [\n\t'Ogerpon', 'Zacian', 'Zamazenta',\n];\n\n/** Priority of offensive item substitutions due to Item Clause */\nconst ATTACK_ITEM_ORDER = [\n\t'Life Orb', 'Gem', 'Expert Belt', 'Type-Raise Item', 'Metronome', 'Stat-Raise Item'\n];\n/** Priority of support item substitutions due to Item Clause */\nconst SUPPORT_ITEM_ORDER = [\n\t'Focus Sash', 'Red Card', 'Mental Herb', 'Safety Goggles', 'Bright Powder', 'Eject Button',\n];\n/** Priority of defense item substitutions due to Item Clause */\nconst DEFENSE_ITEM_ORDER = [\n\t'Heavy-Duty Boots', 'Rocky Helmet', 'Type-Absorb Berry', 'Assault Vest', 'Covert Cloak', 'Stat-Raise Item'\n];\n/** Priority of healing item substitutions due to Item Clause */\nconst HEAL_ITEM_ORDER = [\n\t'Leftovers', 'Sitrus Berry', 'Shell Bell', 'Enigma Berry', 'Pinch Berry', 'Hopo Berry'\n];\n\nconst TYPE_BOOST_ITEMS: {[k: string]: string} = {\n\tNormal: 'Silk Scarf',\n\tFire: 'Charcoal',\n\tWater: 'Mystic Water',\n\tElectric: 'Magnet',\n\tGrass: 'Miracle Seed',\n\tIce: 'Never-Melt Ice',\n\tFighting: 'Black Belt',\n\tPoison: 'Poison Barb',\n\tGround: 'Soft Sand',\n\tFlying: 'Sharp Beak',\n\tPsychic: 'Twisted Spoon',\n\tBug: 'Silver Powder',\n\tRock: 'Hard Stone',\n\tGhost: 'Spell Tag',\n\tDragon: 'Dragon Fang',\n\tDark: 'Black Glasses',\n\tSteel: 'Metal Coat',\n\tFairy: 'Fairy Feather',\n};\nconst TYPE_ABSORB_BERRIES: {[k: string]: string} = {\n\tNormal: 'Chilan Berry',\n\tFire: 'Occa Berry',\n\tWater: 'Passho Berry',\n\tElectric: 'Wacan Berry',\n\tGrass: 'Rindo Berry',\n\tIce: 'Yache Berry',\n\tFighting: 'Chople Berry',\n\tPoison: 'Kasib Berry',\n\tGround: 'Shuca Berry',\n\tFlying: 'Coba Berry',\n\tPsychic: 'Payapa Berry',\n\tBug: 'Tanga Berry',\n\tRock: 'Charti Berry',\n\tGhost: 'Kebia Berry',\n\tDragon: 'Haban Berry',\n\tDark: 'Colbur Berry',\n\tSteel: 'Babiri Berry',\n\tFairy: 'Roseli Berry',\n};\n\nfunction sereneGraceBenefits(move: Move) {\n\treturn move.secondary?.chance && move.secondary.chance >= 20 && move.secondary.chance < 100;\n}\n\nexport class RandomTeams {\n\tdex: ModdedDex;\n\tgen: number;\n\tfactoryTier: string;\n\tformat: Format;\n\tprng: PRNG;\n\tnoStab: string[];\n\treadonly maxTeamSize: number;\n\treadonly adjustLevel: number | null;\n\treadonly maxMoveCount: number;\n\treadonly forceMonotype: string | undefined;\n\n\t/**\n\t * Checkers for move enforcement based on types or other factors\n\t *\n\t * returns true to try to force the move type, false otherwise.\n\t */\n\tmoveEnforcementCheckers: {[k: string]: MoveEnforcementChecker};\n\n\tconstructor(format: Format | string, prng: PRNG | PRNGSeed | null) {\n\t\tformat = Dex.formats.get(format);\n\t\tthis.dex = Dex.forFormat(format);\n\t\tthis.gen = this.dex.gen;\n\t\tthis.noStab = NO_STAB;\n\n\t\tconst ruleTable = Dex.formats.getRuleTable(format);\n\t\tthis.maxTeamSize = ruleTable.maxTeamSize;\n\t\tthis.adjustLevel = ruleTable.adjustLevel;\n\t\tthis.maxMoveCount = ruleTable.maxMoveCount;\n\t\tconst forceMonotype = ruleTable.valueRules.get('forcemonotype');\n\t\tthis.forceMonotype = forceMonotype && this.dex.types.get(forceMonotype).exists ?\n\t\t\tthis.dex.types.get(forceMonotype).name : undefined;\n\n\t\tthis.factoryTier = '';\n\t\tthis.format = format;\n\t\tthis.prng = prng && !Array.isArray(prng) ? prng : new PRNG(prng);\n\n\t\tthis.moveEnforcementCheckers = {\n\t\t\tBug: (movePool, moves, abilities, types, counter) => (\n\t\t\t\tmovePool.includes('attackorder') || movePool.includes('megahorn') || movePool.includes('xscissor') ||\n\t\t\t\t(!counter.get('Bug') && types.includes('Electric'))\n\t\t\t),\n\t\t\tDark: (movePool, moves, abilities, types, counter) => !counter.get('Dark'),\n\t\t\tDragon: (movePool, moves, abilities, types, counter) => !counter.get('Dragon'),\n\t\t\tElectric: (movePool, moves, abilities, types, counter) => !counter.get('Electric'),\n\t\t\tFairy: (movePool, moves, abilities, types, counter) => !counter.get('Fairy'),\n\t\t\tFighting: (movePool, moves, abilities, types, counter) => !counter.get('Fighting'),\n\t\t\tFire: (movePool, moves, abilities, types, counter, species) => !counter.get('Fire'),\n\t\t\tFlying: (movePool, moves, abilities, types, counter) => !counter.get('Flying'),\n\t\t\tGhost: (movePool, moves, abilities, types, counter) => !counter.get('Ghost'),\n\t\t\tGrass: (movePool, moves, abilities, types, counter, species) => (\n\t\t\t\t!counter.get('Grass') && (\n\t\t\t\t\tmovePool.includes('leafstorm') || species.baseStats.atk >= 100 ||\n\t\t\t\t\ttypes.includes('Electric') || abilities.has('Seed Sower')\n\t\t\t\t)\n\t\t\t),\n\t\t\tGround: (movePool, moves, abilities, types, counter) => !counter.get('Ground'),\n\t\t\tIce: (movePool, moves, abilities, types, counter) => (\n\t\t\t\tmovePool.includes('freezedry') || movePool.includes('blizzard') || !counter.get('Ice')\n\t\t\t),\n\t\t\tNormal: (movePool, moves, types, counter) => (movePool.includes('boomburst') || movePool.includes('hypervoice')),\n\t\t\tPoison: (movePool, moves, abilities, types, counter) => {\n\t\t\t\tif (types.includes('Ground')) return false;\n\t\t\t\treturn !counter.get('Poison');\n\t\t\t},\n\t\t\tPsychic: (movePool, moves, abilities, types, counter, species, teamDetails, isLead, isDoubles) => {\n\t\t\t\tif (counter.get('Psychic')) return false;\n\t\t\t\tif (movePool.includes('calmmind') || abilities.has('Strong Jaw')) return true;\n\t\t\t\tif (isDoubles && movePool.includes('psychicfangs')) return true;\n\t\t\t\treturn abilities.has('Psychic Surge') || ['Electric', 'Fighting', 'Fire', 'Grass', 'Poison'].some(m => types.includes(m));\n\t\t\t},\n\t\t\tRock: (movePool, moves, abilities, types, counter, species) => !counter.get('Rock') && species.baseStats.atk >= 80,\n\t\t\tSteel: (movePool, moves, abilities, types, counter, species, teamDetails, isLead, isDoubles) => (\n\t\t\t\t!counter.get('Steel') &&\n\t\t\t\t(isDoubles || species.baseStats.atk >= 90 || movePool.includes('gigatonhammer'))\n\t\t\t),\n\t\t\tWater: (movePool, moves, abilities, types, counter) => (!counter.get('Water') && !types.includes('Ground')),\n\t\t};\n\t}\n\n\tsetSeed(prng?: PRNG | PRNGSeed) {\n\t\tthis.prng = prng && !Array.isArray(prng) ? prng : new PRNG(prng);\n\t}\n\n\tgetTeam(options?: PlayerOptions | null): PokemonSet[] {\n\t\tconst generatorName = (\n\t\t\ttypeof this.format.team === 'string' && this.format.team.startsWith('random')\n\t\t ) ? this.format.team + 'Team' : '';\n\t\t// @ts-ignore\n\t\treturn this[generatorName || 'randomTeam'](options);\n\t}\n\n\trandomChance(numerator: number, denominator: number) {\n\t\treturn this.prng.randomChance(numerator, denominator);\n\t}\n\n\tsample<T>(items: readonly T[]): T {\n\t\treturn this.prng.sample(items);\n\t}\n\n\tsampleIfArray<T>(item: T | T[]): T {\n\t\tif (Array.isArray(item)) {\n\t\t\treturn this.sample(item);\n\t\t}\n\t\treturn item;\n\t}\n\n\trandom(m?: number, n?: number) {\n\t\treturn this.prng.next(m, n);\n\t}\n\n\t/**\n\t * Remove an element from an unsorted array significantly faster\n\t * than .splice\n\t */\n\tfastPop(list: any[], index: number) {\n\t\t// If an array doesn't need to be in order, replacing the\n\t\t// element at the given index with the removed element\n\t\t// is much, much faster than using list.splice(index, 1).\n\t\tconst length = list.length;\n\t\tif (index < 0 || index >= list.length) {\n\t\t\t// sanity check\n\t\t\tthrow new Error(`Index ${index} out of bounds for given array`);\n\t\t}\n\n\t\tconst element = list[index];\n\t\tlist[index] = list[length - 1];\n\t\tlist.pop();\n\t\treturn element;\n\t}\n\n\t/**\n\t * Remove a random element from an unsorted array and return it.\n\t * Uses the battle's RNG if in a battle.\n\t */\n\tsampleNoReplace(list: any[]) {\n\t\tconst length = list.length;\n\t\tif (length === 0) return null;\n\t\tconst index = this.random(length);\n\t\treturn this.fastPop(list, index);\n\t}\n\n\t/**\n\t * Removes n random elements from an unsorted array and returns them.\n\t * If n is less than the array's length, randomly removes and returns all the elements\n\t * in the array (so the returned array could have length < n).\n\t */\n\tmultipleSamplesNoReplace<T>(list: T[], n: number): T[] {\n\t\tconst samples = [];\n\t\twhile (samples.length < n && list.length) {\n\t\t\tsamples.push(this.sampleNoReplace(list));\n\t\t}\n\n\t\treturn samples;\n\t}\n\n\t/**\n\t * Check if user has directly tried to ban/unban/restrict things in a custom battle.\n\t * Doesn't count bans nested inside other formats/rules.\n\t */\n\tprivate hasDirectCustomBanlistChanges() {\n\t\tif (this.format.banlist.length || this.format.restricted.length || this.format.unbanlist.length) return true;\n\t\tif (!this.format.customRules) return false;\n\t\tfor (const rule of this.format.customRules) {\n\t\t\tfor (const banlistOperator of ['-', '+', '*']) {\n\t\t\t\tif (rule.startsWith(banlistOperator)) return true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Inform user when custom bans are unsupported in a team generator.\n\t */\n\tprotected enforceNoDirectCustomBanlistChanges() {\n\t\tif (this.hasDirectCustomBanlistChanges()) {\n\t\t\tthrow new Error(`Custom bans are not currently supported in ${this.format.name}.`);\n\t\t}\n\t}\n\n\t/**\n\t * Inform user when complex bans are unsupported in a team generator.\n\t */\n\tprotected enforceNoDirectComplexBans() {\n\t\tif (!this.format.customRules) return false;\n\t\tfor (const rule of this.format.customRules) {\n\t\t\tif (rule.includes('+') && !rule.startsWith('+')) {\n\t\t\t\tthrow new Error(`Complex bans are not currently supported in ${this.format.name}.`);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Validate set element pool size is sufficient to support size requirements after simple bans.\n\t */\n\tprivate enforceCustomPoolSizeNoComplexBans(\n\t\teffectTypeName: string,\n\t\tbasicEffectPool: BasicEffect[],\n\t\trequiredCount: number,\n\t\trequiredCountExplanation: string\n\t) {\n\t\tif (basicEffectPool.length >= requiredCount) return;\n\t\tthrow new Error(`Legal ${effectTypeName} count is insufficient to support ${requiredCountExplanation} (${basicEffectPool.length} / ${requiredCount}).`);\n\t}\n\n\tqueryMoves(\n\t\tmoves: Set<string> | null,\n\t\tspecies: Species,\n\t\tabilities: Set<string> = new Set(),\n\t): MoveCounter {\n\t\t// This is primarily a helper function for random setbuilder functions.\n\t\tconst counter = new MoveCounter();\n\t\tconst types = species.types;\n\t\tif (!moves?.size) return counter;\n\n\t\tconst categories = {Physical: 0, Special: 0, Status: 0};\n\n\t\t// Iterate through all moves we've chosen so far and keep track of what they do:\n\t\tfor (const moveid of moves) {\n\t\t\tconst move = this.dex.moves.get(moveid);\n\n\t\t\tconst moveType = this.getMoveType(move, species, abilities);\n\t\t\tif (move.damage || move.damageCallback|| moveid === 'equalizer') {\n\t\t\t\t// Moves that do a set amount of damage:\n\t\t\t\tcounter.add('damage');\n\t\t\t\tcounter.damagingMoves.add(move);\n\t\t\t} else {\n\t\t\t\t// Are Physical/Special/Status moves:\n\t\t\t\tcategories[move.category]++;\n\t\t\t}\n\t\t\t// Moves that have a low base power:\n\t\t\tif (moveid === 'lowkick' || (move.basePower && move.basePower <= 60 && moveid !== 'rapidspin')) {\n\t\t\t\tcounter.add('technician');\n\t\t\t}\n\t\t\t// Moves that hit up to 5 times:\n\t\t\tif (move.multihit && Array.isArray(move.multihit) && move.multihit[1] === 5) counter.add('skilllink');\n\t\t\tif (move.recoil || move.hasCrashDamage) counter.add('recoil');\n\t\t\tif (move.drain) counter.add('drain');\n\t\t\t// Moves which have a base power:\n\t\t\tif (move.basePower || move.basePowerCallback) {\n\t\t\t\tif (!this.noStab.includes(moveid) || PRIORITY_POKEMON.includes(species.id) && move.priority > 0) {\n\t\t\t\t\tcounter.add(moveType);\n\t\t\t\t\tif (types.includes(moveType)) counter.add('stab');\n\t\t\t\t\tcounter.damagingMoves.add(move);\n\t\t\t\t}\n\t\t\t\tif (move.flags['bite']) counter.add('strongjaw');\n\t\t\t\tif (move.flags['bludg']) counter.add('bludgeon');\n\t\t\t\tif (move.flags['bullet']) counter.add('megalauncher');\n\t\t\t\tif (move.flags['punch']) counter.ironFist++;\n\t\t\t\tif (move.flags['sound']) counter.add('sound');\n\t\t\t\tif (move.priority > 0) {\n\t\t\t\t\tcounter.add('priority');\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Moves with secondary effects:\n\t\t\tif (move.secondary || move.hasSheerForce) {\n\t\t\t\tcounter.add('sheerforce');\n\t\t\t\tif (sereneGraceBenefits(move)) {\n\t\t\t\t\tcounter.add('serenegrace');\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Moves with low accuracy:\n\t\t\tif (move.accuracy && move.accuracy !== true && move.accuracy < 90) counter.add('inaccurate');\n\n\t\t\t// Moves that change stats:\n\t\t\tif (RECOVERY_MOVES.includes(moveid)) counter.add('recovery');\n\t\t\tif (CONTRARY_MOVES.includes(moveid)) counter.add('contrary');\n\t\t\tif (PHYSICAL_SETUP.includes(moveid)) counter.add('physicalsetup');\n\t\t\tif (SPECIAL_SETUP.includes(moveid)) counter.add('specialsetup');\n\t\t\tif (MIXED_SETUP.includes(moveid)) counter.add('mixedsetup');\n\t\t\tif (SPEED_SETUP.includes(moveid)) counter.add('speedsetup');\n\t\t\tif (SETUP.includes(moveid)) counter.add('setup');\n\t\t\tif (HAZARDS.includes(moveid)) counter.add('hazards');\n\t\t}\n\n\t\tcounter.set('Physical', Math.floor(categories['Physical']));\n\t\tcounter.set('Special', Math.floor(categories['Special']));\n\t\tcounter.set('Status', categories['Status']);\n\t\treturn counter;\n\t}\n\n\tcullMovePool(\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tabilities: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tmovePool: string[],\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t): void {\n\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t// If we have two unfilled moves and only one unpaired move, cull the unpaired move.\n\t\tif (moves.size === this.maxMoveCount - 2) {\n\t\t\tconst unpairedMoves = [...movePool];\n\t\t\tfor (const pair of MOVE_PAIRS) {\n\t\t\t\tif (movePool.includes(pair[0]) && movePool.includes(pair[1])) {\n\t\t\t\t\tthis.fastPop(unpairedMoves, unpairedMoves.indexOf(pair[0]));\n\t\t\t\t\tthis.fastPop(unpairedMoves, unpairedMoves.indexOf(pair[1]));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (unpairedMoves.length === 1) {\n\t\t\t\tthis.fastPop(movePool, movePool.indexOf(unpairedMoves[0]));\n\t\t\t}\n\t\t}\n\n\t\t// These moves are paired, and shouldn't appear if there is not room for them both.\n\t\tif (moves.size === this.maxMoveCount - 1) {\n\t\t\tfor (const pair of MOVE_PAIRS) {\n\t\t\t\tif (movePool.includes(pair[0]) && movePool.includes(pair[1])) {\n\t\t\t\t\tthis.fastPop(movePool, movePool.indexOf(pair[0]));\n\t\t\t\t\tthis.fastPop(movePool, movePool.indexOf(pair[1]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Develop additional move lists\n\t\tconst statusMoves = this.dex.moves.all()\n\t\t\t.filter(move => move.category === 'Status')\n\t\t\t.map(move => move.id);\n\n\t\t// Team-based move culls\n\t\tif (teamDetails.screens && movePool.length >= this.maxMoveCount + 2) {\n\t\t\tif (movePool.includes('reflect')) this.fastPop(movePool, movePool.indexOf('reflect'));\n\t\t\tif (movePool.includes('lightscreen')) this.fastPop(movePool, movePool.indexOf('lightscreen'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\t\tif (teamDetails.stickyWeb) {\n\t\t\tif (movePool.includes('stickyweb')) this.fastPop(movePool, movePool.indexOf('stickyweb'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\t\tif (teamDetails.stealthRock) {\n\t\t\tif (movePool.includes('stealthrock')) this.fastPop(movePool, movePool.indexOf('stealthrock'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\t\tif (teamDetails.defog || teamDetails.rapidSpin) {\n\t\t\tif (movePool.includes('defog')) this.fastPop(movePool, movePool.indexOf('defog'));\n\t\t\tif (movePool.includes('rapidspin')) this.fastPop(movePool, movePool.indexOf('rapidspin'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\t\tif (teamDetails.toxicSpikes && teamDetails.toxicSpikes >= 2) {\n\t\t\tif (movePool.includes('toxicspikes')) this.fastPop(movePool, movePool.indexOf('toxicspikes'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\t\tif (teamDetails.spikes && teamDetails.spikes >= 2) {\n\t\t\tif (movePool.includes('spikes')) this.fastPop(movePool, movePool.indexOf('spikes'));\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t}\n\n\t\tif (isDoubles) {\n\t\t\tconst doublesIncompatiblePairs = [\n\t\t\t\t// In order of decreasing generalizability\n\t\t\t\t[SPEED_CONTROL, SPEED_CONTROL],\n\t\t\t\t[HAZARDS, HAZARDS],\n\t\t\t\t['rockslide', 'stoneedge'],\n\t\t\t\t[SETUP, ['fakeout', 'helpinghand']],\n\t\t\t\t[PROTECT_MOVES, 'wideguard'],\n\t\t\t\t[['fierydance', 'fireblast'], 'heatwave'],\n\t\t\t\t['dazzlinggleam', ['fleurcannon', 'moonblast', 'strangesmoke']],\n\t\t\t\t['poisongas', ['toxicspikes', 'willowisp']],\n\t\t\t\t[RECOVERY_MOVES, 'healpulse'],\n\t\t\t\t['lifedew', 'healpulse'],\n\t\t\t\t['haze', 'icywind'],\n\t\t\t\t[['hydropump', 'muddywater'], ['muddywater', 'scald']],\n\t\t\t\t['disable', 'encore'],\n\t\t\t\t['freezedry', 'icebeam'],\n\t\t\t\t['energyball', 'leafstorm'],\n\t\t\t\t['wildcharge', 'thunderbolt'],\n\t\t\t\t['earthpower', 'sandblast'],\n\t\t\t\t['shadowball', 'eldritchmight'],\n\t\t\t];\n\n\t\t\tfor (const pair of doublesIncompatiblePairs) this.incompatibleMoves(moves, movePool, pair[0], pair[1]);\n\n\t\t\tif (role !== 'Offensive Protect') this.incompatibleMoves(moves, movePool, PROTECT_MOVES, ['flipturn', 'uturn']);\n\t\t}\n\n\t\t// General incompatibilities\n\t\tconst incompatiblePairs = [\n\t\t\t// These moves don't mesh well with other aspects of the set\n\t\t\t[statusMoves, ['healingwish', 'switcheroo', 'trick']],\n\t\t\t[SETUP, PIVOT_MOVES],\n\t\t\t[SETUP, HAZARDS],\n\t\t\t[SETUP, ['defog', 'nuzzle', 'toxic', 'waterspout', 'yawn', 'haze']],\n\t\t\t[PHYSICAL_SETUP, PHYSICAL_SETUP],\n\t\t\t[SPECIAL_SETUP, 'thunderwave'],\n\t\t\t['substitute', PIVOT_MOVES],\n\t\t\t[SPEED_SETUP, ['aquajet', 'rest', 'trickroom']],\n\t\t\t['curse', ['irondefense', 'shelter']],\n\t\t\t['dragondance', 'dracometeor'],\n\n\t\t\t// These attacks are redundant with each other\n\t\t\t['psychic', 'psyshock'],\n\t\t\t['surf', 'hydropump'],\n\t\t\t['liquidation', 'wavecrash'],\n\t\t\t['gigadrain', 'leafstorm'],\n\t\t\t['powerwhip', 'hornleech'],\n\t\t\t[['airslash', 'bravebird', 'fellswoop', 'hurricane'], ['airslash', 'bravebird', 'fellswoop', 'hurricane']],\n\t\t\t['knockoff', 'foulplay'],\n\t\t\t['throatchop', ['crunch', 'compensation']],\n\t\t\t['doubleedge', ['bodyslam', 'headbutt']],\n\t\t\t['fireblast', ['fierydance', 'flamethrower']],\n\t\t\t['lavaplume', 'magmastorm'],\n\t\t\t['thunderpunch', 'wildcharge'],\n\t\t\t['gunkshot', ['direclaw', 'poisonjab', 'sludgebomb']],\n\t\t\t['aurasphere', 'focusblast'],\n\t\t\t['closecombat', 'drainpunch'],\n\t\t\t['bugbite', 'springleap'],\n\t\t\t[['dragonpulse', 'spacialrend'], 'dracometeor'],\n\t\t\t['alluringvoice', 'dazzlinggleam'],\n\n\t\t\t// These status moves are redundant with each other\n\t\t\t['taunt', 'disable'],\n\t\t\t['toxic', ['willowisp', 'thunderwave']],\n\t\t\t[['thunderwave', 'toxic', 'willowisp'], 'toxicspikes'],\n\n\t\t\t// This space reserved for assorted hardcodes that otherwise make little sense out of context\n\t\t\t// Landorus and Thundurus\n\t\t\t['nastyplot', ['rockslide', 'knockoff']],\n\t\t\t// Persian\n\t\t\t['switcheroo', 'fakeout'],\n\t\t\t// Beartic\n\t\t\t['snowscape', 'swordsdance'],\n\t\t\t// Magnezone\n\t\t\t['bodypress', 'mirrorcoat'],\n\t\t\t// Amoonguss, though this can work well as a general rule later\n\t\t\t['toxic', 'clearsmog'],\n\t\t\t// Chansey and Blissey\n\t\t\t['healbell', 'stealthrock'],\n\t\t\t// Azelf and Zoroarks\n\t\t\t['trick', 'uturn'],\n\t\t\t// Araquanid\n\t\t\t['mirrorcoat', 'hydropump'],\n\t\t];\n\n\t\tfor (const pair of incompatiblePairs) this.incompatibleMoves(moves, movePool, pair[0], pair[1]);\n\n\t\tif (!types.includes('Ice')) this.incompatibleMoves(moves, movePool, 'icebeam', 'icywind');\n\n\t\tif (!isDoubles) this.incompatibleMoves(moves, movePool, ['taunt', 'strengthsap'], 'encore');\n\n\t\tif (!types.includes('Dark')) this.incompatibleMoves(moves, movePool, 'knockoff', 'suckerpunch');\n\n\t\tif (!abilities.has('Prankster')) this.incompatibleMoves(moves, movePool, 'thunderwave', 'yawn');\n\n\t\t// This space reserved for assorted hardcodes that otherwise make little sense out of context\n\t\tif (species.baseSpecies === 'Dudunsparce') this.incompatibleMoves(moves, movePool, 'earthpower', 'shadowball');\n\t\tif (species.id === 'mesprit') this.incompatibleMoves(moves, movePool, 'healingwish', 'uturn');\n\t}\n\n\t// Checks for and removes incompatible moves, starting with the first move in movesA.\n\tincompatibleMoves(\n\t\tmoves: Set<string>,\n\t\tmovePool: string[],\n\t\tmovesA: string | string[],\n\t\tmovesB: string | string[],\n\t): void {\n\t\tconst moveArrayA = (Array.isArray(movesA)) ? movesA : [movesA];\n\t\tconst moveArrayB = (Array.isArray(movesB)) ? movesB : [movesB];\n\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\tfor (const moveid1 of moves) {\n\t\t\tif (moveArrayB.includes(moveid1)) {\n\t\t\t\tfor (const moveid2 of moveArrayA) {\n\t\t\t\t\tif (moveid1 !== moveid2 && movePool.includes(moveid2)) {\n\t\t\t\t\t\tthis.fastPop(movePool, movePool.indexOf(moveid2));\n\t\t\t\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (moveArrayA.includes(moveid1)) {\n\t\t\t\tfor (const moveid2 of moveArrayB) {\n\t\t\t\t\tif (moveid1 !== moveid2 && movePool.includes(moveid2)) {\n\t\t\t\t\t\tthis.fastPop(movePool, movePool.indexOf(moveid2));\n\t\t\t\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) return;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Adds a move to the moveset, returns the MoveCounter\n\taddMove(\n\t\tmove: string,\n\t\tmoves: Set<string>,\n\t\ttypes: string[],\n\t\tabilities: Set<string>,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\tmovePool: string[],\n\t\trole: RandomTeamsTypes.Role,\n\t): MoveCounter {\n\t\tmoves.add(move);\n\t\tthis.fastPop(movePool, movePool.indexOf(move));\n\t\tconst counter = this.queryMoves(moves, species, abilities);\n\t\tthis.cullMovePool(types, moves, abilities, counter, movePool, teamDetails, species, isLead, isDoubles, role);\n\t\treturn counter;\n\t}\n\n\t// Returns the type of a given move for STAB/coverage enforcement purposes\n\tgetMoveType(move: Move, species: Species, abilities: Set<string>): string {\n\t\tif (['judgment', 'multiattack', 'revelationdance'].includes(move.id)) return species.types[0];\n\n\t\tif (move.name === \"Bullfight\" && species.name.startsWith(\"Tauros-Paldea\")) {\n\t\t\tif (species.name.endsWith(\"Blaze\")) return \"Fire\";\n\t\t\tif (species.name.endsWith(\"Aqua\")) return \"Water\";\n\t\t}\n\n\t\tif (move.name === \"Ivy Cudgel\" && species.name.startsWith(\"Ogerpon\")) {\n\t\t\tif (species.name.endsWith(\"Wellspring\")) return \"Water\";\n\t\t\tif (species.name.endsWith(\"Hearthflame\")) return \"Fire\";\n\t\t\tif (species.name.endsWith(\"Cornerstone\")) return \"Rock\";\n\t\t}\n\n\t\tconst moveType = move.type;\n\t\tif (moveType === 'Normal') {\n\t\t\tif (abilities.has('Aerilate')) return 'Flying';\n\t\t\tif (abilities.has('Galvanize')) return 'Electric';\n\t\t\tif (abilities.has('Pixilate')) return 'Fairy';\n\t\t\tif (abilities.has('Refrigerate')) return 'Ice';\n\t\t}\n\t\treturn moveType;\n\t}\n\n\t// Generate random moveset for a given species, role.\n\trandomMoveset(\n\t\ttypes: string[],\n\t\tabilities: Set<string>,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\tmovePool: string[],\n\t\trole: RandomTeamsTypes.Role,\n\t): Set<string> {\n\t\tconst moves = new Set<string>();\n\t\tlet counter = this.queryMoves(moves, species, abilities);\n\t\tthis.cullMovePool(types, moves, abilities, counter, movePool, teamDetails, species, isLead, isDoubles, role);\n\n\t\t// If there are only four moves, add all moves and return early\n\t\tif (movePool.length <= this.maxMoveCount) {\n\t\t\tfor (const moveid of movePool) {\n\t\t\t\tmoves.add(moveid);\n\t\t\t}\n\t\t\treturn moves;\n\t\t}\n\n\t\tconst runEnforcementChecker = (checkerName: string) => {\n\t\t\tif (!this.moveEnforcementCheckers[checkerName]) return false;\n\t\t\treturn this.moveEnforcementCheckers[checkerName](\n\t\t\t\tmovePool, moves, abilities, types, counter, species, teamDetails, isLead, isDoubles, role\n\t\t\t);\n\t\t};\n\t\t// Add required move\n\t\tif (species.requiredMove) {\n\t\t\tconst move = this.dex.moves.get(species.requiredMove).id;\n\t\t\tcounter = this.addMove(move, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\tmovePool, role);\n\t\t}\n\n\t\t// Add other moves you really want to have, e.g. STAB, recovery, setup.\n\n\t\t// Enforce Facade if Guts is a possible ability\n\t\tif (movePool.includes('facade') && abilities.has('Guts')) {\n\t\t\tcounter = this.addMove('facade', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\tmovePool, role);\n\t\t}\n\n\t\t// Enforce Night Shade, Revelation Dance, Revival Blessing, and Sticky Web\n\t\tfor (const moveid of ['nightshade', 'revelationdance', 'revivalblessing', 'stickyweb']) {\n\t\t\tif (movePool.includes(moveid)) {\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce Trick Room on Doubles Wallbreaker\n\t\tif (movePool.includes('trickroom') && role === 'Doubles Wallbreaker') {\n\t\t\tcounter = this.addMove('trickroom', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\tmovePool, role);\n\t\t}\n\n\t\t// Enforce hazard removal on Bulky Support if the team doesn't already have it\n\t\tif (role === 'Bulky Support' && !teamDetails.defog && !teamDetails.rapidSpin) {\n\t\t\tif (movePool.includes('rapidspin')) {\n\t\t\t\tcounter = this.addMove('rapidspin', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t\tif (movePool.includes('defog')) {\n\t\t\t\tcounter = this.addMove('defog', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t\tif (movePool.includes('rototiller')) {\n\t\t\t\tcounter = this.addMove('rototiller', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce Knock Off on pure Normal- and Fighting-types in singles\n\t\tif (!isDoubles && types.length === 1 && (types.includes('Normal') || types.includes('Fighting'))) {\n\t\t\tif (movePool.includes('knockoff')) {\n\t\t\t\tcounter = this.addMove('knockoff', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce Spore on Smeargle\n\t\tif (species.id === 'smeargle') {\n\t\t\tif (movePool.includes('spore')) {\n\t\t\t\tcounter = this.addMove('spore', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce moves in doubles\n\t\tif (isDoubles) {\n\t\t\tconst doublesEnforcedMoves = ['auroraveil', 'spore'];\n\t\t\tfor (const moveid of doublesEnforcedMoves) {\n\t\t\t\tif (movePool.includes(moveid)) {\n\t\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Enforce Fake Out on slow Pokemon\n\t\t\tif (movePool.includes('fakeout') && species.baseStats.spe <= 50) {\n\t\t\t\tcounter = this.addMove('fakeout', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t\t// Enforce Tailwind on Prankster and Gale Wings users\n\t\t\tif (movePool.includes('tailwind') && (abilities.has('Prankster') || abilities.has('Gale Wings'))) {\n\t\t\t\tcounter = this.addMove('tailwind', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t\t// Enforce Thunder Wave on Prankster users as well\n\t\t\tif (movePool.includes('thunderwave') && abilities.has('Prankster')) {\n\t\t\t\tcounter = this.addMove('thunderwave', moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce STAB priority\n\t\tif (\n\t\t\t['Bulky Attacker', 'Bulky Setup', 'Wallbreaker', 'Doubles Wallbreaker'].includes(role) ||\n\t\t\tPRIORITY_POKEMON.includes(species.id)\n\t\t) {\n\t\t\tconst priorityMoves = [];\n\t\t\tfor (const moveid of movePool) {\n\t\t\t\tconst move = this.dex.moves.get(moveid);\n\t\t\t\tconst moveType = this.getMoveType(move, species, abilities);\n\t\t\t\tif (\n\t\t\t\t\ttypes.includes(moveType) && (move.priority > 0) &&\n\t\t\t\t\t(move.basePower || move.basePowerCallback)\n\t\t\t\t) {\n\t\t\t\t\tpriorityMoves.push(moveid);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (priorityMoves.length) {\n\t\t\t\tconst moveid = this.sample(priorityMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce STAB\n\t\tfor (const type of types) {\n\t\t\t// Check if a STAB move of that type should be required\n\t\t\tconst stabMoves = [];\n\t\t\tfor (const moveid of movePool) {\n\t\t\t\tconst move = this.dex.moves.get(moveid);\n\t\t\t\tconst moveType = this.getMoveType(move, species, abilities);\n\t\t\t\tconst twoType = move.twoType;\n\t\t\t\tif (!this.noStab.includes(moveid) && (move.basePower || move.basePowerCallback) && (type === moveType || type === twoType)) {\n\t\t\t\t\tstabMoves.push(moveid);\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (runEnforcementChecker(type)) {\n\t\t\t\tif (!stabMoves.length) break;\n\t\t\t\tconst moveid = this.sampleNoReplace(stabMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// If no STAB move was added, add a STAB move\n\t\tif (!counter.get('stab')) {\n\t\t\tconst stabMoves = [];\n\t\t\tfor (const moveid of movePool) {\n\t\t\t\tconst move = this.dex.moves.get(moveid);\n\t\t\t\tconst moveType = this.getMoveType(move, species, abilities);\n\t\t\t\tif (!this.noStab.includes(moveid) && (move.basePower || move.basePowerCallback) && types.includes(moveType)) {\n\t\t\t\t\tstabMoves.push(moveid);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (stabMoves.length) {\n\t\t\t\tconst moveid = this.sample(stabMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce recovery\n\t\tif (['Bulky Support', 'Bulky Attacker', 'Bulky Setup'].includes(role)) {\n\t\t\tconst recoveryMoves = movePool.filter(moveid => RECOVERY_MOVES.includes(moveid));\n\t\t\tif (recoveryMoves.length) {\n\t\t\t\tconst moveid = this.sample(recoveryMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce setup\n\t\tif (role.includes('Setup')) {\n\t\t\t// First, try to add a non-Speed setup move\n\t\t\tconst nonSpeedSetupMoves = movePool.filter(moveid => SETUP.includes(moveid) && !SPEED_SETUP.includes(moveid));\n\t\t\tif (nonSpeedSetupMoves.length) {\n\t\t\t\tconst moveid = this.sample(nonSpeedSetupMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t} else {\n\t\t\t\t// No non-Speed setup moves, so add any (Speed) setup move\n\t\t\t\tconst setupMoves = movePool.filter(moveid => SETUP.includes(moveid));\n\t\t\t\tif (setupMoves.length) {\n\t\t\t\t\tconst moveid = this.sample(setupMoves);\n\t\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Enforce redirecting moves and Fake Out on Doubles Support\n\t\tif (role === 'Doubles Support') {\n\t\t\tfor (const moveid of ['fakeout', 'followme', 'ragepowder']) {\n\t\t\t\tif (movePool.includes(moveid)) {\n\t\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Enforce Protect\n\t\tif (role.includes('Protect')) {\n\t\t\tconst protectMoves = movePool.filter(moveid => PROTECT_MOVES.includes(moveid));\n\t\t\tif (protectMoves.length) {\n\t\t\t\tconst moveid = this.sample(protectMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce a move not on the noSTAB list\n\t\tif (!counter.damagingMoves.size) {\n\t\t\t// Choose an attacking move\n\t\t\tconst attackingMoves = [];\n\t\t\tfor (const moveid of movePool) {\n\t\t\t\tconst move = this.dex.moves.get(moveid);\n\t\t\t\tif (!this.noStab.includes(moveid) && (move.category !== 'Status')) attackingMoves.push(moveid);\n\t\t\t}\n\t\t\tif (attackingMoves.length) {\n\t\t\t\tconst moveid = this.sample(attackingMoves);\n\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\tmovePool, role);\n\t\t\t}\n\t\t}\n\n\t\t// Enforce coverage move\n\t\tif (!['AV Pivot', 'Fast Support', 'Bulky Support', 'Bulky Protect', 'Doubles Support'].includes(role)) {\n\t\t\tif (counter.damagingMoves.size === 1) {\n\t\t\t\t// Find the type of the current attacking move\n\t\t\t\tconst currentAttackType = counter.damagingMoves.values().next().value.type;\n\t\t\t\t// Choose an attacking move that is of different type to the current single attack\n\t\t\t\tconst coverageMoves = [];\n\t\t\t\tfor (const moveid of movePool) {\n\t\t\t\t\tconst move = this.dex.moves.get(moveid);\n\t\t\t\t\tconst moveType = this.getMoveType(move, species, abilities);\n\t\t\t\t\tif (!this.noStab.includes(moveid) && (move.basePower || move.basePowerCallback)) {\n\t\t\t\t\t\tif (currentAttackType !== moveType) coverageMoves.push(moveid);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (coverageMoves.length) {\n\t\t\t\t\tconst moveid = this.sample(coverageMoves);\n\t\t\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add (moves.size < this.maxMoveCount) as a condition if moves is getting larger than 4 moves.\n\t\t// If you want moves to be favored but not required, add something like && this.randomChance(1, 2) to your condition.\n\n\t\t// Choose remaining moves randomly from movepool and add them to moves list:\n\t\twhile (moves.size < this.maxMoveCount && movePool.length) {\n\t\t\tif (moves.size + movePool.length <= this.maxMoveCount) {\n\t\t\t\tfor (const moveid of movePool) {\n\t\t\t\t\tmoves.add(moveid);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tconst moveid = this.sample(movePool);\n\t\t\tcounter = this.addMove(moveid, moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\tmovePool, role);\n\t\t\tfor (const pair of MOVE_PAIRS) {\n\t\t\t\tif (moveid === pair[0] && movePool.includes(pair[1])) {\n\t\t\t\t\tcounter = this.addMove(pair[1], moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t\tif (moveid === pair[1] && movePool.includes(pair[0])) {\n\t\t\t\t\tcounter = this.addMove(pair[0], moves, types, abilities, teamDetails, species, isLead, isDoubles,\n\t\t\t\t\t\tmovePool, role);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn moves;\n\t}\n\n\tshouldCullAbility(\n\t\tability: string,\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tabilities: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t): boolean {\n\t\tif ([\n\t\t\t'Early Bird', 'Gluttony', 'Harvest', 'Hydration', 'Ice Body', 'Liquid Voice',\n\t\t\t'Marvel Scale', 'Misty Surge', 'Moody', 'Pressure', 'Quick Feet', 'Rain Dish', 'Sand Veil',\n\t\t\t'Shed Skin', 'Sniper', 'Snow Cloak', 'Steadfast', 'Steam Engine', 'Sweet Veil',\n\t\t].includes(ability)) return true;\n\n\t\tswitch (ability) {\n\t\t// Abilities which are primarily useful for certain moves\n\t\tcase 'Contrary': case 'Serene Grace': case 'Skill Link': case 'Strong Jaw':\n\t\t\treturn !counter.get(toID(ability));\n\t\tcase 'Chlorophyll':\n\t\t\treturn (!moves.has('sunnyday') && !teamDetails.sun && species.id !== 'lilligant');\n\t\tcase 'Cloud Nine':\n\t\t\treturn (species.id !== 'golduck');\n\t\tcase 'Competitive':\n\t\t\treturn (species.id === 'kilowattrel' && !isDoubles);\n\t\tcase 'Compound Eyes': case 'No Guard':\n\t\t\treturn !counter.get('inaccurate');\n\t\tcase 'Cursed Body':\n\t\t\treturn abilities.has('Infiltrator');\n\t\tcase 'Defiant':\n\t\t\treturn (!counter.get('Physical') || (abilities.has('Prankster') && (moves.has('thunderwave') || moves.has('taunt'))));\n\t\tcase 'Flame Body':\n\t\t\treturn (species.id === 'magcargo' && moves.has('shellsmash'));\n\t\tcase 'Flash Fire':\n\t\t\treturn (\n\t\t\t\t['Drought', 'Flame Body', 'Intimidate', 'Rock Head', 'Weak Armor'].some(m => abilities.has(m)) &&\n\t\t\t\tthis.dex.getEffectiveness('Fire', species) < 0\n\t\t\t);\n\t\tcase 'Guts':\n\t\t\treturn (!moves.has('facade') && !moves.has('sleeptalk'));\n\t\tcase 'Hustle':\n\t\t\t// some of this is just for Delibird in singles/doubles\n\t\t\treturn (!counter.get('Physical') || moves.has('fakeout') || moves.has('rapidspin'));\n\t\tcase 'Immunity': case 'Overcoat':\n\t\t\treturn types.includes('Grass');\n\t\tcase 'Infiltrator':\n\t\t\treturn (isDoubles && abilities.has('Clear Body'));\n\t\tcase 'Insomnia':\n\t\t\treturn role === 'Wallbreaker' || !moves.has('midnight');\n\t\tcase 'Intimidate':\n\t\t\tif (abilities.has('Hustle')) return true;\n\t\t\tif (abilities.has('Sheer Force') && !!counter.get('sheerforce')) return true;\n\t\t\treturn (abilities.has('Stakeout'));\n\t\tcase 'Iron Fist':\n\t\t\treturn !counter.ironFist || moves.has('dynamicpunch');\n\t\tcase 'Justified':\n\t\t\treturn !counter.get('Physical');\n\t\tcase 'Lightning Rod':\n\t\t\treturn species.id === 'rhyperior';\n\t\tcase 'Mold Breaker':\n\t\t\treturn (['Pickpocket', 'Sharpness', 'Sheer Force', 'Unburden'].some(m => abilities.has(m)));\n\t\tcase 'Moxie':\n\t\t\treturn (!counter.get('Physical') || moves.has('stealthrock'));\n\t\tcase 'Natural Cure':\n\t\t\treturn species.id === 'pawmot';\n\t\tcase 'Neutralizing Gas':\n\t\t\treturn !isDoubles;\n\t\tcase 'Night Walker':\n\t\t\treturn !moves.has('midnight');\n\t\tcase 'Overgrow':\n\t\t\treturn !counter.get('Grass');\n\t\tcase 'Own Tempo':\n\t\t\treturn (!isDoubles || (counter.get('Special')) > 1);\n\t\tcase 'Prankster':\n\t\t\treturn (!counter.get('Status') || (species.id === 'grafaiai' && role === 'Setup Sweeper'));\n\t\tcase 'Reckless':\n\t\t\treturn !counter.get('recoil');\n\t\tcase 'Regenerator':\n\t\t\treturn (species.id === 'mienshao' && role === 'Wallbreaker');\n\t\tcase 'Rock Head':\n\t\t\treturn !counter.get('recoil');\n\t\tcase 'Sand Force': case 'Sand Rush':\n\t\t\treturn !moves.has('sandstorm') || !teamDetails.sand;\n\t\tcase 'Sap Sipper':\n\t\t\treturn species.id === 'wyrdeer';\n\t\tcase 'Seed Sower':\n\t\t\treturn role === 'Bulky Support';\n\t\tcase 'Sheer Force':\n\t\t\tconst braviaryCase = (species.id === 'braviaryhisui' && (role === 'Wallbreaker' || role === 'Bulky Protect'));\n\t\t\tconst abilitiesCase = (abilities.has('Guts') || abilities.has('Sharpness'));\n\t\t\tconst movesCase = (moves.has('bellydrum') || moves.has('flamecharge'));\n\t\t\treturn (!counter.get('sheerforce') || braviaryCase || abilitiesCase || movesCase);\n\t\tcase 'Snow Plow':\n\t\t\treturn !moves.has('snowscape') || !teamDetails.snow;\n\t\tcase 'Solar Power':\n\t\t\treturn (!moves.has('sunnyday') || !teamDetails.sun) || !counter.get('Special');\n\t\tcase 'Speed Boost':\n\t\t\treturn (species.id === 'yanmega' && !moves.has('protect'));\n\t\tcase 'Sticky Hold':\n\t\t\treturn species.id === 'muk';\n\t\tcase 'Sturdy':\n\t\t\treturn (!!counter.get('recoil') && species.id !== 'skarmory');\n\t\tcase 'Swarm':\n\t\t\treturn (!counter.get('Bug') || !!counter.get('recovery'));\n\t\tcase 'Swift Swim':\n\t\t\treturn (abilities.has('Intimidate') || (!moves.has('raindance') && !teamDetails.rain));\n\t\tcase 'Synchronize':\n\t\t\treturn (species.id !== 'umbreon' && species.id !== 'rabsca');\n\t\tcase 'Technician':\n\t\t\treturn (!counter.get('technician') || abilities.has('Cacophony') || abilities.has('Fur Coat'));\n\t\tcase 'Tinted Lens':\n\t\t\tconst yanmegaCase = (species.id === 'yanmega' && moves.has('protect'));\n\t\t\treturn (yanmegaCase || species.id === 'illumise');\n\t\tcase 'Unaware':\n\t\t\treturn (species.id === 'clefable' && role !== 'Bulky Support');\n\t\tcase 'Unburden':\n\t\t\treturn (abilities.has('Prankster') || !counter.get('setup') || species.id === 'sceptile');\n\t\tcase 'Vital Spirit':\n\t\t\t// Magmar and Electabuzz want their contact status abilities in Doubles\n\t\t\treturn (species.nfe && isDoubles);\n\t\tcase 'Volt Absorb':\n\t\t\tif (abilities.has('Iron Fist') && counter.ironFist >= 2) return true;\n\t\t\treturn (this.dex.getEffectiveness('Electric', species) < -1);\n\t\tcase 'Water Absorb':\n\t\t\treturn (['lanturn', 'politoed', 'quagsire'].includes(species.id) || moves.has('raindance'));\n\t\tcase 'Weak Armor':\n\t\t\treturn moves.has('shellsmash') || moves.has('storedpower');\n\t\t}\n\n\t\treturn false;\n\t}\n\n\n\tgetAbility(\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tabilities: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t): string {\n\t\tif (species.battleOnly && !species.requiredAbility) {\n\t\t\tabilities = new Set(Object.values(this.dex.species.get(species.battleOnly as string).abilities));\n\t\t}\n\t\tconst abilityData = Array.from(abilities).map(a => this.dex.abilities.get(a));\n\t\tUtils.sortBy(abilityData, abil => -abil.rating);\n\n\t\tif (abilityData.length <= 1) return abilityData[0].name;\n\n\t\t// Hard-code abilities here\n\t\tif (species.id === 'florges') return 'Flower Veil';\n\t\tif (species.id === 'bombirdier' && !counter.get('Rock')) return 'Big Pecks';\n\t\tif (species.id === 'scovillain') return 'Chlorophyll';\n\t\tif (species.id === 'empoleon') return 'Competitive';\n\t\tif (species.id === 'swampert' && !counter.get('Water')) return 'Damp';\n\t\tif (species.id === 'dodrio') return 'Early Bird';\n\t\tif (species.id === 'chandelure') return 'Flash Fire';\n\t\tif (species.id === 'golemalola' && (moves.has('doubleedge') || moves.has('rapidspin'))) return 'Galvanize';\n\t\tif (abilities.has('Guts') && (moves.has('facade') || moves.has('sleeptalk') || species.id === 'gurdurr')) return 'Guts';\n\t\tif (species.id === 'copperajah' && moves.has('heavyslam')) return 'Heavy Metal';\n\t\tif (species.id === 'jumpluff') return 'Infiltrator';\n\t\tif (species.id === 'toucannon' && !counter.get('skilllink')) return 'Keen Eye';\n\t\tif (species.id === 'reuniclus') return moves.has('psybubble') ? 'Regenerator' : 'Magic Guard';\n\t\tif (species.id === 'smeargle' && !counter.get('technician')) return 'Own Tempo';\n\t\t// If Ambipom doesn't qualify for Technician, Skill Link is useless on it\n\t\tif (species.id === 'ambipom' && !counter.get('technician')) return 'Pickup';\n\t\tif (species.id === 'zebstrika') return (moves.has('volttackle')) ? 'Sap Sipper' : 'Lightning Rod';\n\t\tif (species.id === 'sandaconda' || (species.id === 'scrafty' && moves.has('rest'))) return 'Shed Skin';\n\t\tif (species.id === 'cetitan' && (role === 'Wallbreaker' || isDoubles)) return 'Sheer Force';\n\t\tif (species.id === 'dipplin') return 'Sticky Hold';\n\t\tif (species.id === 'breloom') return 'Technician';\n\t\tif (species.id === 'shiftry' && moves.has('tailwind')) return 'Wind Rider';\n\n\t\t// singles\n\t\tif (!isDoubles) {\n\t\t\tif (species.id === 'hypno') return 'Insomnia';\n\t\t\tif (species.id === 'staraptor') return 'Reckless';\n\t\t\tif (species.id === 'arcaninehisui') return 'Rock Head';\n\t\t\tif (['raikou', 'suicune', 'vespiquen'].includes(species.id)) return 'Pressure';\n\t\t\tif (species.id === 'enamorus' && moves.has('calmmind')) return 'Cute Charm';\n\t\t\tif (species.id === 'klawf' && role === 'Setup Sweeper') return 'Berserk';\n\t\t\tif (abilities.has('Harvest') && (moves.has('protect') || moves.has('substitute'))) return 'Harvest';\n\t\t\tif (abilities.has('Serene Grace') && moves.has('headbutt')) return 'Serene Grace';\n\t\t\tif (abilities.has('Own Tempo') && moves.has('petaldance')) return 'Own Tempo';\n\t\t\tif (abilities.has('Snow Plow') && moves.has('snowscape')) return 'Snow Plow';\n\t\t\tif (abilities.has('Soundproof') && (moves.has('substitute') || counter.get('setup'))) return 'Soundproof';\n\t\t}\n\n\t\t// doubles, multi, and ffa\n\t\tif (isDoubles) {\n\t\t\tif (species.id === 'gumshoos' || species.id === 'porygonz') return 'Adaptability';\n\t\t\tif (species.id === 'dragapult') return 'Clear Body';\n\t\t\tif (species.id === 'altaria') return 'Cloud Nine';\n\t\t\tif (species.id === 'meowsticf') return 'Competitive';\n\t\t\tif (species.id === 'armarouge' && !moves.has('meteorbeam')) return 'Flash Fire';\n\t\t\tif (species.id === 'talonflame') return 'Gale Wings';\n\t\t\tif (\n\t\t\t\t['oinkologne', 'oinkolognef', 'snorlax', 'swalot'].includes(species.id) && role !== 'Doubles Wallbreaker'\n\t\t\t) return 'Gluttony';\n\t\t\tif (species.id === 'conkeldurr' && role === 'Doubles Wallbreaker') return 'Guts';\n\t\t\tif (species.id !== 'arboliva' && abilities.has('Harvest')) return 'Harvest';\n\t\t\tif (species.id === 'dragonite' || species.id === 'lucario') return 'Inner Focus';\n\t\t\tif (species.id === 'ariados') return 'Insomnia';\n\t\t\tif (species.id === 'primarina') return 'Liquid Voice';\n\t\t\tif (species.id === 'kommoo') return 'Soundproof';\n\t\t\tif (\n\t\t\t\t(species.id === 'flapple' && role === 'Doubles Bulky Attacker') ||\n\t\t\t\t(species.id === 'appletun' && this.randomChance(1, 2))\n\t\t\t) return 'Ripen';\n\t\t\tif (species.id === 'magnezone') return 'Sturdy';\n\t\t\tif (species.id === 'clefable' && role === 'Doubles Support') return 'Unaware';\n\t\t\tif (['drifblim', 'hitmonlee', 'sceptile'].includes(species.id)) return 'Unburden';\n\t\t\tif (abilities.has('Intimidate')) return 'Intimidate';\n\n\t\t\tif (this.randomChance(1, 2) && species.id === 'kingambit') return 'Defiant';\n\n\t\t\t// just doubles and multi\n\t\t\tif (this.format.gameType !== 'freeforall') {\n\t\t\t\tif (\n\t\t\t\t\tspecies.id === 'clefairy' ||\n\t\t\t\t\t(species.baseSpecies === 'Maushold' && role === 'Doubles Support')\n\t\t\t\t) return 'Friend Guard';\n\t\t\t\tif (species.id === 'blissey') return 'Healer';\n\t\t\t\tif (species.id === 'sinistcha') return 'Hospitality';\n\t\t\t\tif (species.id === 'duraludon') return 'Stalwart';\n\t\t\t\tif (species.id === 'barraskewda') return 'Against Current';\n\t\t\t\tif (species.id === 'oranguru' || abilities.has('Pressure') && abilities.has('Telepathy')) return 'Telepathy';\n\t\t\t}\n\t\t}\n\n\t\tlet abilityAllowed: Ability[] = [];\n\t\t// Obtain a list of abilities that are allowed (not culled)\n\t\tfor (const ability of abilityData) {\n\t\t\tif (ability.rating >= 1 && !this.shouldCullAbility(\n\t\t\t\tability.name, types, moves, abilities, counter, teamDetails, species, isLead, isDoubles, role\n\t\t\t)) {\n\t\t\t\tabilityAllowed.push(ability);\n\t\t\t}\n\t\t}\n\n\t\t// If all abilities are rejected, re-allow all abilities\n\t\tif (!abilityAllowed.length) {\n\t\t\tfor (const ability of abilityData) {\n\t\t\t\tif (ability.rating > 0) abilityAllowed.push(ability);\n\t\t\t}\n\t\t\tif (!abilityAllowed.length) abilityAllowed = abilityData;\n\t\t}\n\n\t\tif (abilityAllowed.length === 1) return abilityAllowed[0].name;\n\t\t// Sort abilities by rating with an element of randomness\n\t\t// All three abilities can be chosen\n\t\tif (abilityAllowed[2] && abilityAllowed[0].rating - 0.5 <= abilityAllowed[2].rating) {\n\t\t\tif (abilityAllowed[1].rating <= abilityAllowed[2].rating) {\n\t\t\t\tif (this.randomChance(1, 2)) [abilityAllowed[1], abilityAllowed[2]] = [abilityAllowed[2], abilityAllowed[1]];\n\t\t\t} else {\n\t\t\t\tif (this.randomChance(1, 3)) [abilityAllowed[1], abilityAllowed[2]] = [abilityAllowed[2], abilityAllowed[1]];\n\t\t\t}\n\t\t\tif (abilityAllowed[0].rating <= abilityAllowed[1].rating) {\n\t\t\t\tif (this.randomChance(2, 3)) [abilityAllowed[0], abilityAllowed[1]] = [abilityAllowed[1], abilityAllowed[0]];\n\t\t\t} else {\n\t\t\t\tif (this.randomChance(1, 2)) [abilityAllowed[0], abilityAllowed[1]] = [abilityAllowed[1], abilityAllowed[0]];\n\t\t\t}\n\t\t} else {\n\t\t\t// Third ability cannot be chosen\n\t\t\tif (abilityAllowed[0].rating <= abilityAllowed[1].rating) {\n\t\t\t\tif (this.randomChance(1, 2)) [abilityAllowed[0], abilityAllowed[1]] = [abilityAllowed[1], abilityAllowed[0]];\n\t\t\t} else if (abilityAllowed[0].rating - 0.5 <= abilityAllowed[1].rating) {\n\t\t\t\tif (this.randomChance(1, 3)) [abilityAllowed[0], abilityAllowed[1]] = [abilityAllowed[1], abilityAllowed[0]];\n\t\t\t}\n\t\t}\n\n\t\t// After sorting, choose the first ability\n\t\treturn abilityAllowed[0].name;\n\t}\n\n\tgetPriorityItem(\n\t\tability: string,\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\tisDoubles: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t) {\n\t\tif (!isDoubles) {\n\t\t\tif (\n\t\t\t\t!isLead && role === 'Bulky Setup' &&\n\t\t\t\t(ability === 'Quark Drive' || ability === 'Protosynthesis')\n\t\t\t) {\n\t\t\t\treturn 'Booster Energy';\n\t\t\t}\n\t\t\tif (species.id === 'lokix') {\n\t\t\t\treturn (role === 'Fast Attacker') ? 'Silver Powder' : 'Life Orb';\n\t\t\t}\n\t\t}\n\t\tif (species.requiredItems) {\n\t\t\tif (species.baseSpecies === 'Arceus') {\n\t\t\t\treturn species.requiredItems[0];\n\t\t\t}\n\t\t\treturn this.sample(species.requiredItems);\n\t\t}\n\t\tif (role === 'AV Pivot') return 'Assault Vest';\n\t\tif (species.id === 'pikachu') return 'Light Ball';\n\t\tif (species.id === 'marowak' || species.id === 'marowakalola') return 'Thick Club';\n\t\tif (species.id === 'kendono' || species.id === 'sirfetchd') return 'Leek';\n\t\tif (species.id === 'smeargle') return 'Focus Sash';\n\t\tif (\n\t\t\tspecies.id === 'necrozmaduskmane' || (species.id === 'calyrexice' && isDoubles)\n\t\t) return 'Weakness Policy';\n\t\tif (species.id === 'necrozmadawnwings') return (role === 'Setup Sweeper' ? 'Ultranecrozium Z' : 'Leftovers');\n\t\tif (moves.has('lastrespects') || moves.has('dragonenergy')) return 'Choice Scarf';\n\t\tif (\n\t\t\tability === 'Imposter' ||\n\t\t\t(species.id === 'magnezone' && moves.has('bodypress') && !isDoubles)\n\t\t) return 'Choice Scarf';\n\t\tif (species.id === 'rampardos' && (role === 'Fast Attacker' || isDoubles)) return 'Choice Scarf';\n\t\tif (species.id === 'luvdisc' && moves.has('substitute')) return 'Heavy-Duty Boots';\n\t\tif (moves.has('bellydrum') && moves.has('substitute')) return 'Salac Berry';\n\t\tif (\n\t\t\t['Cheek Pouch', 'Harvest', 'Ripen'].some(m => ability === m) ||\n\t\t\tmoves.has('bellydrum') || moves.has('filletaway')\n\t\t) {\n\t\t\treturn 'Sitrus Berry';\n\t\t}\n\t\tif (['healingwish', 'switcheroo', 'trick'].some(m => moves.has(m))) {\n\t\t\tif (\n\t\t\t\tspecies.baseStats.spe >= 60 && species.baseStats.spe <= 108 &&\n\t\t\t\trole !== 'Wallbreaker' && role !== 'Doubles Wallbreaker' && !counter.get('priority')\n\t\t\t) {\n\t\t\t\treturn 'Choice Scarf';\n\t\t\t} else {\n\t\t\t\treturn (counter.get('Physical') > counter.get('Special')) ? 'Choice Band' : 'Choice Specs';\n\t\t\t}\n\t\t}\n\t\tif (ability === 'Poison Heal' || ability === 'Toxic Boost') return 'Toxic Orb';\n\t\tif (ability === 'Flare Boost') return 'Flame Orb';\n\t\tif ((ability === 'Guts' || moves.has('facade')) && !moves.has('sleeptalk')) {\n\t\t\treturn types.includes('Fire') ? 'Toxic Orb' : 'Flame Orb';\n\t\t}\n\t\tif (species.id === 'scyther' && !isDoubles) return (isLead && !moves.has('uturn')) ? 'Eviolite' : 'Heavy-Duty Boots';\n\t\tif (species.id === 'twintura') return 'Protective Pads';\n\t\tif (species.nfe) return 'Eviolite';\n\t\tif (moves.has('courtchange')) return 'Heavy-Duty Boots';\n\t\tif (moves.has('populationbomb')) return 'Wide Lens';\n\t\tif ((species.id === 'ambipom' && role !== 'Wallbreaker')) return 'Loaded Dice';\n\t\tif (ability === 'Unburden') {\n\t\t\treturn (moves.has('closecombat') || moves.has('leafstorm')) ? 'White Herb' : 'Sitrus Berry';\n\t\t}\n\t\tif (moves.has('shellsmash') && ability !== 'Weak Armor') return 'White Herb';\n\t\tif (moves.has('meteorbeam')) return 'Power Herb';\n\t\tif (['flareblitz', 'headsmash', 'wavecrash', 'woodhammer', 'volttackle'].some(m => moves.has(m)) && ability !== 'Rock Head') return 'Protector';\n\t\tif (moves.has('acrobatics') && ability !== 'Protosynthesis') return 'Flying Gem';\n\t\tif (moves.has('auroraveil') || (moves.has('lightscreen') && moves.has('reflect'))) return 'Light Clay';\n\t\t//if (ability === 'Gluttony') return `${this.sample(['Aguav', 'Figy', 'Iapapa', 'Mago', 'Wiki'])} Berry`;\n\t\tif (\n\t\t\tmoves.has('rest') && !moves.has('sleeptalk') &&\n\t\t\tability !== 'Natural Cure' && ability !== 'Shed Skin'\n\t\t) {\n\t\t\treturn 'Chesto Berry';\n\t\t}\n\t\tif (\n\t\t\tspecies.id !== 'yanmega' &&\n\t\t\tthis.dex.getEffectiveness('Rock', species) >= 2 && (!types.includes('Flying') || !isDoubles)\n\t\t) return 'Heavy-Duty Boots';\n\t}\n\n\t/** Item generation specific to Random Doubles */\n\tgetDoublesItem(\n\t\tability: string,\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t): string {\n\t\tconst scarfReqs = (\n\t\t\t!counter.get('priority') && ability !== 'Speed Boost' && role !== 'Doubles Wallbreaker' &&\n\t\t\tspecies.baseStats.spe >= 60 && species.baseStats.spe <= 108 &&\n\t\t\tthis.randomChance(1, 2)\n\t\t);\n\t\tconst offensiveRole = (\n\t\t\t['Doubles Fast Attacker', 'Doubles Wallbreaker', 'Doubles Setup Sweeper', 'Offensive Protect'].some(m => role === m)\n\t\t);\n\n\t\tif ((moves.has('doubleedge') && moves.has('fakeout'))) return 'Silk Scarf';\n\t\tif (\n\t\t\tmoves.has('aquajet') && moves.has('protect') && (moves.has('liquidation') || (moves.has('wavecrash') || moves.has('crabhammer')))\n\t\t) return 'Mystic Water';\n\t\tif (moves.has('dragondance') || mvoes.has('sharpen')) return 'Clear Amulet';\n\t\tif (moves.has('waterspout')) return 'Choice Scarf';\n\t\tif (counter.get('speedsetup') && role === 'Doubles Bulky Setup') return 'Weakness Policy';\n\t\tif (species.id === 'toxapex') return 'Binding Band';\n\t\tif (moves.has('blizzard') && ability !== 'Snow Warning' && !teamDetails.snow) return 'Blunder Policy';\n\n\t\tif (role === 'Choice Item user') {\n\t\t\tif (scarfReqs || (counter.get('Physical') < 4 && counter.get('Special') < 3 && !moves.has('memento'))) {\n\t\t\t\treturn 'Choice Scarf';\n\t\t\t}\n\t\t\treturn (counter.get('Physical') >= 3) ? 'Choice Band' : 'Choice Specs';\n\t\t}\n\t\tif (counter.get('Physical') >= 4 &&\n\t\t\t['fakeout', 'feint', 'firstimpression', 'suckerpunch'].every(m => !moves.has(m)) &&\n\t\t\t(moves.has('voltswitch') || moves.has('uturn') || role === 'Doubles Wallbreaker')\n\t\t) {\n\t\t\treturn (scarfReqs) ? 'Choice Scarf' : 'Choice Band';\n\t\t}\n\t\tif (\n\t\t\t((counter.get('Special') >= 4 && (moves.has('voltswitch') || role === 'Doubles Wallbreaker')) || (\n\t\t\t\tcounter.get('Special') >= 3 && (moves.has('uturn') || moves.has('voltswitch'))\n\t\t\t)) && !moves.has('electroweb')\n\t\t) {\n\t\t\treturn (scarfReqs) ? 'Choice Scarf' : 'Choice Specs';\n\t\t}\n\t\tif (species.name === 'Latias' || species.name === 'Latios') return 'Soul Dew';\n\t\tif (\n\t\t\t(role === 'Bulky Protect' && counter.get('setup')) || moves.has('substitute') ||\n\t\t\tspecies.id === 'eternatus'\n\t\t) return 'Leftovers';\n\t\tif (species.id === 'sylveon') return 'Fairy Feather';\n\t\tif (\n\t\t\toffensiveRole &&\n\t\t\t(!moves.has('fakeout') || species.id === 'ambipom') && !moves.has('incinerate') &&\n\t\t\t(!moves.has('uturn') || types.includes('Bug') || species.baseStats.atk >= 120 || ability === 'Libero') &&\n\t\t\t((!moves.has('icywind') && !moves.has('electroweb')) || species.id === 'robobundle')\n\t\t) {\n\t\t\treturn (\n\t\t\t\t(ability === 'Quark Drive' || ability === 'Protosynthesis') &&\n\t\t\t\t['firstimpression', 'uturn', 'voltswitch'].every(m => !moves.has(m)) && species.id !== 'valiantdroid'\n\t\t\t) ? 'Booster Energy' : 'Life Orb';\n\t\t}\n\t\tif (isLead && (species.id === 'glimmora' ||\n\t\t\t(['Doubles Fast Attacker', 'Doubles Wallbreaker', 'Offensive Protect'].includes(role) &&\n\t\t\tspecies.baseStats.hp + species.baseStats.def + species.baseStats.spd <= 230))\n\t\t) return 'Focus Sash';\n\t\tif (\n\t\t\t['Doubles Fast Attacker', 'Doubles Wallbreaker', 'Offensive Protect'].includes(role) &&\n\t\t\tmoves.has('fakeout') || moves.has('incinerate')\n\t\t) {\n\t\t\treturn (this.dex.getEffectiveness('Rock', species) >= 1) ? 'Heavy-Duty Boots' : 'Clear Amulet';\n\t\t}\n\t\tif (!counter.get('Status')) return 'Assault Vest';\n\t\treturn 'Sitrus Berry';\n\t}\n\n\tgetItem(\n\t\tability: string,\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\tcounter: MoveCounter,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails,\n\t\tspecies: Species,\n\t\tisLead: boolean,\n\t\trole: RandomTeamsTypes.Role,\n\t): string {\n\t\tif (types.includes('Normal') && moves.has('fakeout')) return 'Silk Scarf';\n\t\tif (\n\t\t\tspecies.id !== 'jirachi' && (counter.get('Physical') >= 4) &&\n\t\t\t['fakeout', 'firstimpression', 'flamecharge', 'rapidspin', 'ruination', 'superfang', 'trailhead'].every(m => !moves.has(m))\n\t\t) {\n\t\t\tconst scarfReqs = (\n\t\t\t\trole !== 'Wallbreaker' &&\n\t\t\t\t(species.baseStats.atk >= 100 || ability === 'Huge Power' || ability === 'Pure Power') &&\n\t\t\t\tspecies.baseStats.spe >= 60 && species.baseStats.spe <= 108 &&\n\t\t\t\tability !== 'Speed Boost' && !counter.get('priority') && !moves.has('aquastep')\n\t\t\t);\n\t\t\treturn (scarfReqs && this.randomChance(1, 2)) ? 'Choice Scarf' : 'Choice Band';\n\t\t}\n\t\tif (\n\t\t\t(counter.get('Special') >= 4) ||\n\t\t\t(counter.get('Special') >= 3 && ['partingshot', 'uturn'].some(m => moves.has(m)))\n\t\t) {\n\t\t\tconst scarfReqs = (\n\t\t\t\trole !== 'Wallbreaker' &&\n\t\t\t\tspecies.baseStats.spa >= 100 &&\n\t\t\t\tspecies.baseStats.spe >= 60 && species.baseStats.spe <= 108 &&\n\t\t\t\tability !== 'Speed Boost' && ability !== 'Tinted Lens' && !counter.get('Physical')\n\t\t\t);\n\t\t\treturn (scarfReqs && this.randomChance(1, 2)) ? 'Choice Scarf' : 'Choice Specs';\n\t\t}\n\t\tif (counter.get('speedsetup') && role === 'Bulky Setup') return 'Weakness Policy';\n\t\tif (\n\t\t\t!counter.get('Status') &&\n\t\t\t(moves.has('rapidspin') || !['Fast Attacker', 'Wallbreaker',].includes(role))\n\t\t) {\n\t\t\treturn 'Assault Vest';\n\t\t}\n\t\tif (species.id === 'golem') return (counter.get('speedsetup')) ? 'Weakness Policy' : 'Custap Berry';\n\t\tif (species.id === 'palkia') return 'Lustrous Orb';\n\t\tif (moves.has('substitute')) return 'Leftovers';\n\t\tif (moves.has('stickyweb') && species.id !== 'araquanid' && isLead) return 'Focus Sash';\n\t\tif (this.dex.getEffectiveness('Rock', species) >= 1) return 'Heavy-Duty Boots';\n\t\tif (\n\t\t\t(\n\t\t\t\trole === 'Fast Support' &&\n\t\t\t\t[...PIVOT_MOVES, 'defog', 'rapidspin', 'rototiller'].some(m => moves.has(m)) &&\n\t\t\t\t!types.includes('Flying') && ability !== 'Levitate'\n\t\t\t)\n\t\t) return 'Heavy-Duty Boots';\n\n\t\t// Low Priority\n\t\tif (\n\t\t\t(species.id === 'garchomp' && role === 'Fast Support') || (\n\t\t\t\tability === 'Regenerator' && (role === 'Bulky Support' || role === 'Bulky Attacker') &&\n\t\t\t\t(species.baseStats.hp + species.baseStats.def) >= 180 && this.randomChance(1, 2)\n\t\t\t)\n\t\t) return 'Rocky Helmet';\n\t\tif (moves.has('outrage')) return 'Lum Berry';\n\t\tif (moves.has('protect')) return 'Leftovers';\n\t\tif (\n\t\t\trole === 'Fast Support' && isLead &&\n\t\t\t!counter.get('recovery') && !counter.get('recoil') &&\n\t\t\t(species.baseStats.hp + species.baseStats.def + species.baseStats.spd) < 258\n\t\t) return 'Focus Sash';\n\t\tif (\n\t\t\t!['Fast Attacker', 'Wallbreaker',].includes(role) && ability !== 'Levitate' &&\n\t\t\tthis.dex.getEffectiveness('Ground', species) >= 2\n\t\t) return 'Air Balloon';\n\t\tif (['Bulky Attacker', 'Bulky Support', 'Bulky Setup'].some(m => role === (m))) return 'Leftovers';\n\t\tif (species.id === 'pawmot' && moves.has('nuzzle')) return 'Hopo Berry';\n\t\tif (\n\t\t\t['Fast Bulky Setup', 'Fast Attacker', 'Setup Sweeper', 'Wallbreaker'].some(m => role === m) &&\n\t\t\ttypes.includes('Dark') && moves.has('suckerpunch') && !PRIORITY_POKEMON.includes(species.id) &&\n\t\t\tcounter.get('physicalsetup') && counter.get('Dark')\n\t\t) return 'Black Glasses';\n\t\tif (role === 'Fast Support' || role === 'Fast Bulky Setup') {\n\t\t\treturn (counter.get('Physical') + counter.get('Special') >= 3 && !moves.has('nuzzle')) ? 'Life Orb' : 'Leftovers';\n\t\t}\n\t\tif (\n\t\t\t['flamecharge', 'trailhead'].every(m => !moves.has(m)) &&\n\t\t\t['Fast Attacker', 'Setup Sweeper', 'Wallbreaker'].some(m => role === (m))\n\t\t) return 'Life Orb';\n\t\treturn 'Leftovers';\n\t}\n\t\n\tresolveRepeatItem(\n\t\titem: string,\n\t\tability: string,\n\t\ttypes: string[],\n\t\tmoves: Set<string>,\n\t\titemList: string[],\n\t\tspecies: Species,\n\t): string {\n\t\tif (item.startsWith('Choice') || ATTACK_ITEM_ORDER.includes(item)) {\n\t\t\tfor (const nextItem of ATTACK_ITEM_ORDER) {\n\t\t\t\tif (itemList.includes(nextItem)) continue;\n\t\t\t\tswitch (nextItem) {\n\t\t\t\t\tcase ('Gem'):\n\t\t\t\t\tcase ('Type-Raise Item'):\n\t\t\t\t\t\t// Gather types with moves that can be boosted in the order of: user's types, preferredTypes in the set, other attacking moves\n\t\t\t\t\t\tlet pickedTypes = [];\n\t\t\t\t\t\tconsole.log(\"Type Gem flag\");\n\t\t\t\t\t\tconsole.log([...moves]);\n\t\t\t\t\t\tlet attackTypes = [];\n\t\t\t\t\t\tfor (const m of [...moves]) {\n\t\t\t\t\t\t\tconst move = this.dex.moves.get(m);\n\t\t\t\t\t\t\tif (move.category !== 'Status') attackTypes.push(move.type);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconsole.log(attackTypes);\n\t\t\t\t\t\tattackTypes = attackTypes.filter((m) => m !== null);\n\t\t\t\t\t\t//User's types\n\t\t\t\t\t\tfor (const type of types) {\n\t\t\t\t\t\t\tif (attackTypes.includes(type)) pickedTypes.push(type);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//preferredTypes\n\t\t\t\t\t\tif (!pickedTypes && set.preferredTypes) {\n\t\t\t\t\t\t\tfor (const type of set.preferredTypes) {\n\t\t\t\t\t\t\t\tif(attackTypes.includes(type)) pickedTypes.push(type);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//other attacking moves only if neither of the above (very rare)\n\t\t\t\t\t\tif(!Object.keys(pickedTypes).length) pickedType = attackTypes;\n\t\t\t\t\t\t//Search for an available item for any of these types\n\t\t\t\t\t\tfor(const type of pickedTypes){\n\t\t\t\t\t\t\titem = (item === 'Gem' ? (type + ' Gem') : TYPE_BOOST_ITEMS[type]);\n\t\t\t\t\t\t\tif (!itemList.includes(item)) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase('Stat-Raise Item'):\n\t\t\t\t\t\titem = (species.baseStats.atk >= species.baseStats.spa ? 'Muscle Band' : 'Wise Glasses');\n\t\t\t\t\t\tif (itemList.includes(item)) continue;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\titem = nextItem;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (SUPPORT_ITEM_ORDER.includes(item)) {\n\t\t\tfor (const nextItem of SUPPORT_ITEM_ORDER) {\n\t\t\t\tif (itemList.includes(nextItem)) continue;\n\t\t\t\titem = nextItem;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (item === 'Eviolite' || DEFENSE_ITEM_ORDER.includes(item)) {\n\t\t\tfor (const nextItem of DEFENSE_ITEM_ORDER) {\n\t\t\t\tif (itemList.includes(nextItem)) continue;\n\t\t\t\tswitch (nextItem) {\n\t\t\t\t\tcase ('Type-Absorb Berry'):\n\t\t\t\t\t\t//Get all weaknesses\n\t\t\t\t\t\tconsole.log(\"Type Berry flag\");\n\t\t\t\t\t\tlet pickedTypes = this.dex.types.all().filter(type => this.dex.getEffectiveness(type, types) > 0 && this.dex.getImmunity(type, types));\n\t\t\t\t\t\tconst doubledTypes = pickedTypes.filter(type => this.dex.getEffectiveness(type, types) === 2);\n\t\t\t\t\t\tif (doubledTypes.length) { //Prioritize double-weaknesses\n\t\t\t\t\t\t\tpickedTypes = [...doubledTypes, ...pickedTypes];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//Search for an available item for any of these types\n\t\t\t\t\t\tfor(const type of pickedTypes){\n\t\t\t\t\t\t\titem = TYPE_ABSORB_BERRIES[type];\n\t\t\t\t\t\t\tif (!itemList.includes(item)) break;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase('Stat-Raise Item'):\n\t\t\t\t\t\titem = (species.baseStats.def >= species.baseStats.spd ? 'Dragon Scale' : 'Prism Scale');\n\t\t\t\t\t\tif (itemList.includes(item)) continue;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\titem = nextItem;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (item === 'Black Sludge' || HEAL_ITEM_ORDER.includes(item)) {\n\t\t\tfor (const nextItem of HEAL_ITEM_ORDER) {\n\t\t\t\tif (itemList.includes(nextItem)) continue;\n\t\t\t\tif (nextItem === 'Pinch Berry') {\n\t\t\t\t\t//TODO: Assign a nature based on stats; should probably do that for everyone? But it's needed for pinch berries to be useful\n\t\t\t\t\titem = `${this.sample(['Aguav', 'Figy', 'Iapapa', 'Mago', 'Wiki'])} Berry`;\n\t\t\t\t} else item = nextItem;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn item;\n\t}\n\n\tgetLevel(\n\t\tspecies: Species,\n\t\tisDoubles: boolean,\n\t): number {\n\t\tif (this.adjustLevel) return this.adjustLevel;\n\t\t// doubles levelling\n\t\tif (isDoubles && this.randomDoublesSets[species.id][\"level\"]) return this.randomDoublesSets[species.id][\"level\"]!;\n\t\tif (!isDoubles && this.randomSets[species.id][\"level\"]) return this.randomSets[species.id][\"level\"]!;\n\t\t// Default to tier-based levelling\n\t\tconst tier = species.tier;\n\t\tconst tierScale: Partial<Record<Species['tier'], number>> = {\n\t\t\tUber: 76,\n\t\t\tOU: 80,\n\t\t\tUUBL: 81,\n\t\t\tUU: 82,\n\t\t\tRUBL: 83,\n\t\t\tRU: 84,\n\t\t\tNUBL: 85,\n\t\t\tNU: 86,\n\t\t\tPUBL: 87,\n\t\t\tPU: 88, \"(PU)\": 88, NFE: 88,\n\t\t};\n\t\treturn tierScale[tier] || 80;\n\t}\n\n\trandomSet(\n\t\ts: string | Species,\n\t\tteamDetails: RandomTeamsTypes.TeamDetails = {},\n\t\titemList: string[],\n\t\tisLead = false,\n\t\tisDoubles = false\n\t): RandomTeamsTypes.RandomSet {\n\t\tconst species = this.dex.species.get(s);\n\t\tlet forme = species.name;\n\n\t\tif (typeof species.battleOnly === 'string') {\n\t\t\t// Only change the forme. The species has custom moves, and may have different typing and requirements.\n\t\t\tforme = species.battleOnly;\n\t\t}\n\t\tif (species.cosmeticFormes) {\n\t\t\tforme = this.sample([species.name].concat(species.cosmeticFormes));\n\t\t}\n\t\tconst sets = (this as any)[`random${isDoubles ? 'Doubles' : ''}Sets`][species.id][\"sets\"];\n\t\tconst possibleSets = [];\n\n\t\tconst ruleTable = this.dex.formats.getRuleTable(this.format);\n\n\t\tfor (const set of sets) {\n\t\t\tpossibleSets.push(set);\n\t\t}\n\t\tlet set = this.sampleIfArray(possibleSets);\n\t\tconst role = set.role;\n\t\tconst movePool: string[] = [];\n\t\tconsole.log(forme);\n\t\tconsole.log(set);\n\t\tfor (const movename of set.movepool) {\n\t\t\tmovePool.push(this.dex.moves.get(movename).id);\n\t\t}\n\n\t\tlet ability = '';\n\t\tlet item = undefined;\n\n\t\tconst evs = {hp: 85, atk: 85, def: 85, spa: 85, spd: 85, spe: 85};\n\t\tconst ivs = {hp: 31, atk: 31, def: 31, spa: 31, spd: 31, spe: 31};\n\n\t\tconst types = species.types;\n\t\tconst abilities = new Set(Object.values(species.abilities));\n\n\t\t// Get moves\n\t\tconst moves = this.randomMoveset(types, abilities, teamDetails, species, isLead, isDoubles, movePool, role);\n\t\tconst counter = this.queryMoves(moves, species, abilities);\n\n\t\t// Get ability\n\t\tability = this.getAbility(types, moves, abilities, counter, teamDetails, species, isLead, isDoubles, role);\n\n\t\t// Get items\n\t\t// First, the priority items\n\t\titem = this.getPriorityItem(ability, types, moves, counter, teamDetails, species, isLead, isDoubles, role);\n\t\tif (item === undefined) {\n\t\t\tif (isDoubles) {\n\t\t\t\titem = this.getDoublesItem(ability, types, moves, counter, teamDetails, species, isLead, role);\n\t\t\t} else {\n\t\t\t\titem = this.getItem(ability, types, moves, counter, teamDetails, species, isLead, role);\n\t\t\t}\n\t\t}\n\t\tif (item === 'Leftovers' && types.includes('Poison')) {\n\t\t\titem = 'Black Sludge';\n\t\t}\n\t\t// Go down item ladder if needed for Item Clause\n\t\tif (itemList.includes(item)){\n\t\t\titem = this.resolveRepeatItem(item, ability, types, moves, itemList, species);\n\t\t}\n\n\t\t// Get level\n\t\tconst level = this.getLevel(species, isDoubles);\n\n\t\t// We use a special variable to track Hidden Power\n\t\t// so that we can check for all Hidden Powers at once\n\t\tlet hasHiddenPower = false;\n\t\tfor (const move of moves) {\n\t\t\tif (move.startsWith('hiddenpower')) hasHiddenPower = true;\n\t\t}\n\n\t\t// Fix IVs for non-Bottle Cap-able sets\n\t\tif (hasHiddenPower && level < 100) {\n\t\t\tlet hpType;\n\t\t\tfor (const move of moves) {\n\t\t\t\tif (move.startsWith('hiddenpower')) hpType = move.substr(11);\n\t\t\t}\n\t\t\tif (!hpType) throw new Error(`hasHiddenPower is true, but no Hidden Power move was found.`);\n\t\t\tconst HPivs = ivs.atk === 0 ? ZeroAttackHPIVs[hpType] : this.dex.types.get(hpType).HPivs;\n\t\t\tlet iv: StatID;\n\t\t\tfor (iv in HPivs) {\n\t\t\t\tivs[iv] = HPivs[iv]!;\n\t\t\t}\n\t\t}\n\n\t\t// Prepare optimal HP\n\t\tconst srImmunity = types.includes('Rock') || ability === 'Magic Guard' || item === 'Heavy-Duty Boots';\n\t\tlet srWeakness = srImmunity ? 0 : this.dex.getEffectiveness('Rock', species);\n\t\t// Crash damage move users want an odd HP to survive two misses\n\t\tif (['highjumpkick', 'jumpkick', 'particleslam'].some(m => moves.has(m))) srWeakness = 2;\n\t\twhile (evs.hp > 1) {\n\t\t\tconst hp = Math.floor(Math.floor(2 * species.baseStats.hp + ivs.hp + Math.floor(evs.hp / 4) + 100) * level / 100 + 10);\n\t\t\tif ((moves.has('substitute') && ['Sitrus Berry', 'Salac Berry'].includes(item))) {\n\t\t\t\t// Two Substitutes should activate Sitrus Berry\n\t\t\t\tif (hp % 4 === 0) break;\n\t\t\t} else if ((moves.has('bellydrum') || moves.has('filletaway')) && (item === 'Sitrus Berry' || ability === 'Gluttony')) {\n\t\t\t\t// Belly Drum should activate Sitrus Berry\n\t\t\t\tif (hp % 2 === 0) break;\n\t\t\t} else if (moves.has('substitute') && moves.has('endeavor')) {\n\t\t\t\t// Luvdisc should be able to Substitute down to very low HP\n\t\t\t\tif (hp % 4 > 0) break;\n\t\t\t} else {\n\t\t\t\t// Maximize number of Stealth Rock switch-ins\n\t\t\t\tif (srWeakness <= 0 || ability === 'Regenerator' || ['Leftovers', 'Life Orb'].includes(item)) break;\n\t\t\t\tif (item !== 'Sitrus Berry' && hp % (4 / srWeakness) > 0) break;\n\t\t\t\t// Minimise number of Stealth Rock switch-ins to activate Sitrus Berry\n\t\t\t\tif (item === 'Sitrus Berry' && hp % (4 / srWeakness) === 0) break;\n\t\t\t}\n\t\t\tevs.hp -= 4;\n\t\t}\n\n\t\t// Minimize confusion damage\n\t\tconst noAttackStatMoves = [...moves].every(m => {\n\t\t\tconst move = this.dex.moves.get(m);\n\t\t\tif (move.damageCallback || move.damage) return true;\n\t\t\treturn move.category !== 'Physical' || move.id === 'bodypress' || move.id === 'foulplay';\n\t\t});\n\t\tif (noAttackStatMoves && !moves.has('transform')) {\n\t\t\tevs.atk = 0;\n\t\t\tivs.atk = 0;\n\t\t}\n\n\t\tif (['gyroball', 'metalburst', 'trickroom'].some(m => moves.has(m))) {\n\t\t\tevs.spe = 0;\n\t\t\tivs.spe = (hasHiddenPower && level < 100) ? ivs.spe - 30 : 0;\n\t\t}\n\n\t\t// Ensure Nihilego's Beast Boost gives it Special Attack boosts instead of Special Defense\n\t\tif (forme === 'Nihilego') {\n\t\t\twhile (evs.spd > 1) {\n\t\t\t\tconst spa = Math.floor(Math.floor(2 * species.baseStats.spa + ivs.spa + Math.floor(evs.spa / 4)) * level / 100 + 5);\n\t\t\t\tconst spd = Math.floor(Math.floor(2 * species.baseStats.spd + ivs.spd + Math.floor(evs.spd / 4)) * level / 100 + 5);\n\t\t\t\tif (spa >= spd) break;\n\t\t\t\tevs.spd -= 4;\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tname: species.baseSpecies,\n\t\t\tspecies: forme,\n\t\t\tgender: species.gender,\n\t\t\tshiny: this.randomChance(1, 1024),\n\t\t\tlevel,\n\t\t\tmoves,\n\t\t\tability,\n\t\t\tevs,\n\t\t\tivs,\n\t\t\titem,\n\t\t\trole,\n\t\t};\n\t}\n\n\tgetPokemonPool(\n\t\ttype: string,\n\t\tpokemonToExclude: RandomTeamsTypes.RandomSet[] = [],\n\t\tisMonotype = false,\n\t\tpokemonList: string[]\n\t) {\n\t\tconst exclude = pokemonToExclude.map(p => toID(p.species));\n\t\tconst pokemonPool = [];\n\t\tconst baseSpeciesPool = [];\n\t\tconst baseSpeciesCount: {[k: string]: number} = {};\n\t\tfor (const pokemon of pokemonList) {\n\t\t\tlet species = this.dex.species.get(pokemon);\n\t\t\tif (exclude.includes(species.id)) continue;\n\t\t\tif (isMonotype) {\n\t\t\t\tif (!species.types.includes(type)) continue;\n\t\t\t\tif (typeof species.battleOnly === 'string') {\n\t\t\t\t\tspecies = this.dex.species.get(species.battleOnly);\n\t\t\t\t\tif (!species.types.includes(type)) continue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tpokemonPool.push(pokemon);\n\t\t\tbaseSpeciesCount[species.baseSpecies] = (baseSpeciesCount[species.baseSpecies] || 0) + 1;\n\t\t}\n\t\t// Include base species 1x if 1-3 formes, 2x if 4-6 formes, 3x if 7+ formes\n\t\tfor (const baseSpecies of Object.keys(baseSpeciesCount)) {\n\t\t\tfor (let i = 0; i < Math.min(Math.ceil(baseSpeciesCount[baseSpecies] / 3), 3); i++) {\n\t\t\t\tbaseSpeciesPool.push(baseSpecies);\n\t\t\t}\n\t\t}\n\t\treturn [pokemonPool, baseSpeciesPool];\n\t}\n\n\trandomSets: {[species: string]: RandomTeamsTypes.RandomSpeciesData} = require('./random-sets.json');\n\t//randomDoublesSets: {[species: string]: RandomTeamsTypes.RandomSpeciesData} = require('./random-doubles-sets.json');\n\n\trandomTeam() {\n\t\tthis.enforceNoDirectCustomBanlistChanges();\n\n\t\tconst seed = this.prng.seed;\n\t\tconst ruleTable = this.dex.formats.getRuleTable(this.format);\n\t\tconst pokemon: RandomTeamsTypes.RandomSet[] = [];\n\n\t\t// For Monotype\n\t\tconst isMonotype = !!this.forceMonotype || ruleTable.has('sametypeclause');\n\t\tconst isDoubles = this.format.gameType !== 'singles';\n\t\tconst typePool = this.dex.types.names();\n\t\tconst type = this.forceMonotype || this.sample(typePool);\n\n\t\t// PotD stuff\n\t\tconst usePotD = global.Config && Config.potd && ruleTable.has('potd');\n\t\tconst potd = usePotD ? this.dex.species.get(Config.potd) : null;\n\n\t\tconst baseFormes: {[k: string]: number} = {};\n\t\tlet hasMega = false;\n\n\t\tconst typeCount: {[k: string]: number} = {};\n\t\tconst typeComboCount: {[k: string]: number} = {};\n\t\tconst typeWeaknesses: {[k: string]: number} = {};\n\t\tconst teamDetails: RandomTeamsTypes.TeamDetails = {};\n\t\tconst itemList = [];\n\t\tlet numMaxLevelPokemon = 0;\n\n\t\tconst pokemonList = isDoubles ? Object.keys(this.randomDoublesSets) : Object.keys(this.randomSets);\n\t\tconst [pokemonPool, baseSpeciesPool] = this.getPokemonPool(type, pokemon, isMonotype, pokemonList);\n\n\t\tlet leadsRemaining = this.format.gameType === 'doubles' ? 2 : 1;\n\t\twhile (baseSpeciesPool.length && pokemon.length < this.maxTeamSize) {\n\t\t\tconst baseSpecies = this.sampleNoReplace(baseSpeciesPool);\n\t\t\tconst currentSpeciesPool: Species[] = [];\n\t\t\t// Check if the base species has a mega forme available\n\t\t\tlet canMega = false;\n\t\t\tfor (const poke of pokemonPool) {\n\t\t\t\tconst species = this.dex.species.get(poke);\n\t\t\t\tif (!hasMega && species.baseSpecies === baseSpecies && species.isMega) canMega = true;\n\t\t\t}\n\t\t\tfor (const poke of pokemonPool) {\n\t\t\t\tconst species = this.dex.species.get(poke);\n\t\t\t\tif (species.baseSpecies === baseSpecies) {\n\t\t\t\t\t// Prevent multiple megas\n\t\t\t\t\tif (hasMega && species.isMega) continue;\n\t\t\t\t\t// Prevent base forme, if a mega is available\n\t\t\t\t\tif (canMega && !species.isMega) continue;\n\t\t\t\t\tcurrentSpeciesPool.push(species);\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet species = this.sample(currentSpeciesPool);\n\t\t\tif (!species.exists) continue;\n\n\t\t\t// Limit to one of each species (Species Clause)\n\t\t\tif (baseFormes[species.baseSpecies]) continue;\n\n\t\t\t// Limit one Mega per team\n\t\t\tif (hasMega && species.isMega) continue;\n\n\t\t\t// Illusion shouldn't be on the last slot\n\t\t\tif (species.baseSpecies === 'Zoroark' && pokemon.length >= (this.maxTeamSize - 1)) continue;\n\n\t\t\tconst types = species.types;\n\t\t\tconst typeCombo = types.slice().sort().join();\n\t\t\tconst weakToFreezeDry = (\n\t\t\t\tthis.dex.getEffectiveness('Ice', species) > 0 ||\n\t\t\t\t(this.dex.getEffectiveness('Ice', species) > -2 && types.includes('Water'))\n\t\t\t);\n\t\t\t// Dynamically scale limits for different team sizes. The default and minimum value is 1.\n\t\t\tconst limitFactor = Math.round(this.maxTeamSize / 6) || 1;\n\n\t\t\tif (!isMonotype && !this.forceMonotype) {\n\t\t\t\tlet skip = false;\n\n\t\t\t\t// Limit two of any type\n\t\t\t\tfor (const typeName of types) {\n\t\t\t\t\tif (typeCount[typeName] >= 2 * limitFactor) {\n\t\t\t\t\t\tskip = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (skip) continue;\n\n\t\t\t\t// Limit three weak to any type\n\t\t\t\tfor (const typeName of this.dex.types.names()) {\n\t\t\t\t\t// it's weak to the type\n\t\t\t\t\tif (this.dex.getEffectiveness(typeName, species) > 0) {\n\t\t\t\t\t\tif (!typeWeaknesses[typeName]) typeWeaknesses[typeName] = 0;\n\t\t\t\t\t\tif (typeWeaknesses[typeName] >= 3 * limitFactor) {\n\t\t\t\t\t\t\tskip = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (skip) continue;\n\n\t\t\t\t// Limit four weak to Freeze-Dry\n\t\t\t\tif (weakToFreezeDry) {\n\t\t\t\t\tif (!typeWeaknesses['Freeze-Dry']) typeWeaknesses['Freeze-Dry'] = 0;\n\t\t\t\t\tif (typeWeaknesses['Freeze-Dry'] >= 4 * limitFactor) continue;\n\t\t\t\t}\n\n\t\t\t\t// Limit one level 100 Pokemon\n\t\t\t\tif (!this.adjustLevel && (this.getLevel(species, isDoubles) === 100) && numMaxLevelPokemon >= limitFactor) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Limit three of any type combination in Monotype\n\t\t\tif (!this.forceMonotype && isMonotype && (typeComboCount[typeCombo] >= 3 * limitFactor)) continue;\n\n\t\t\t// The Pokemon of the Day\n\t\t\tif (potd?.exists && (pokemon.length === 1 || this.maxTeamSize === 1)) species = potd;\n\n\t\t\tlet set: RandomTeamsTypes.RandomSet;\n\n\t\t\tif (leadsRemaining) {\n\t\t\t\tif (\n\t\t\t\t\tNO_LEAD_POKEMON.includes(species.baseSpecies)\n\t\t\t\t) {\n\t\t\t\t\tif (pokemon.length + leadsRemaining === this.maxTeamSize) continue;\n\t\t\t\t\tset = this.randomSet(species, teamDetails, itemList, false, isDoubles);\n\t\t\t\t\tpokemon.push(set);\n\t\t\t\t} else {\n\t\t\t\t\tset = this.randomSet(species, teamDetails, itemList, true, isDoubles);\n\t\t\t\t\tpokemon.unshift(set);\n\t\t\t\t\tleadsRemaining--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tset = this.randomSet(species, teamDetails, itemList, false, isDoubles);\n\t\t\t\tpokemon.push(set);\n\t\t\t}\n\n\t\t\t// Don't bother tracking details for the last Pokemon\n\t\t\tif (pokemon.length === this.maxTeamSize) break;\n\n\t\t\t// Now that our Pokemon has passed all checks, we can increment our counters\n\t\t\tbaseFormes[species.baseSpecies] = 1;\n\n\t\t\t// Increment type counters\n\t\t\tfor (const typeName of types) {\n\t\t\t\tif (typeName in typeCount) {\n\t\t\t\t\ttypeCount[typeName]++;\n\t\t\t\t} else {\n\t\t\t\t\ttypeCount[typeName] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeCombo in typeComboCount) {\n\t\t\t\ttypeComboCount[typeCombo]++;\n\t\t\t} else {\n\t\t\t\ttypeComboCount[typeCombo] = 1;\n\t\t\t}\n\n\t\t\t// Increment weakness counter\n\t\t\tfor (const typeName of this.dex.types.names()) {\n\t\t\t\t// it's weak to the type\n\t\t\t\tif (this.dex.getEffectiveness(typeName, species) > 0) {\n\t\t\t\t\ttypeWeaknesses[typeName]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (weakToFreezeDry) typeWeaknesses['Freeze-Dry']++;\n\n\t\t\t// Increment level 100 counter\n\t\t\tconsole.log(set);\n\t\t\tif (set.level === 100) numMaxLevelPokemon++;\n\n\n\t\t\t// Track what the team has\n\t\t\tif (set.item) {\n\t\t\t\tif (this.dex.items.get(set.item).megaStone) hasMega = true;\n\t\t\t\telse itemList.push(set.item);\n\t\t\t}\n\t\t\tif (set.ability === 'Drizzle' || set.moves.includes('raindance')) teamDetails.rain = 1;\n\t\t\tif (set.ability === 'Drought' || set.ability === 'Orichalcum Pulse' || set.moves.includes('sunnyday')) {\n\t\t\t\tteamDetails.sun = 1;\n\t\t\t}\n\t\t\tif (set.ability === 'Sand Stream' || set.moves.includes('sandstorm')) teamDetails.sand = 1;\n\t\t\tif (set.ability === 'Snow Warning' || set.moves.includes('snowscape')) {\n\t\t\t\tteamDetails.snow = 1;\n\t\t\t}\n\t\t\tif (set.moves.includes('spikes')) {\n\t\t\t\tteamDetails.spikes = (teamDetails.spikes || 0) + 1;\n\t\t\t}\n\t\t\tif (set.moves.includes('toxicspikes') || set.ability === 'Toxic Debris') {\n\t\t\t\tteamDetails.toxicSpikes = (teamDetails.toxicSpikes || 0) + 1;\n\t\t\t}\n\t\t\tif (set.moves.includes('stealthrock')) teamDetails.stealthRock = 1;\n\t\t\tif (set.moves.includes('stickyweb')) teamDetails.stickyWeb = 1;\n\t\t\tif (set.moves.includes('defog')) teamDetails.defog = 1;\n\t\t\tif (set.moves.includes('rapidspin')) teamDetails.rapidSpin = 1;\n\t\t\tif (set.moves.includes('auroraveil') || (set.moves.includes('reflect') && set.moves.includes('lightscreen'))) {\n\t\t\t\tteamDetails.screens = 1;\n\t\t\t}\n\t\t}\n\t\tif (pokemon.length < this.maxTeamSize && pokemon.length < 12) { // large teams sometimes cannot be built\n\t\t\tthrow new Error(`Could not build a random team for ${this.format} (seed=${seed})`);\n\t\t}\n\n\t\treturn pokemon;\n\t}\n\n\trandomCCTeam(): RandomTeamsTypes.RandomSet[] {\n\t\tthis.enforceNoDirectCustomBanlistChanges();\n\n\t\tconst dex = this.dex;\n\t\tconst team = [];\n\t\tconst itemList = [];\n\n\t\tconst natures = this.dex.natures.all();\n\t\tconst items = this.dex.items.all();\n\n\t\tconst randomN = this.randomNPokemon(this.maxTeamSize, this.forceMonotype, undefined, undefined, true);\n\n\t\tfor (let forme of randomN) {\n\t\t\tlet species = dex.species.get(forme);\n\t\t\tif (species.isNonstandard) species = dex.species.get(species.baseSpecies);\n\n\t\t\t// Random legal item\n\t\t\tlet item = '';\n\t\t\tlet isIllegalItem;\n\t\t\tlet isBadItem;\n\t\t\tlet isUsedItem;\n\t\t\tlet itemData;\n\t\t\tdo {\n\t\t\t\titem = this.sample(items).name;\n\t\t\t\titemData = this.dex.items.get(item);\n\t\t\t\tisIllegalItem = itemData.isNonstandard;\n\t\t\t\tisUsedItem = itemList.includes(item);\n\t\t\t\tisBadItem = item.startsWith(\"TR\") || itemData.isPokeball || itemData.rating === 0;\n\t\t\t} while (isIllegalItem || isUsedItem || (isBadItem && this.randomChance(19, 20)));\n\n\t\t\t// Make sure forme is legal\n\t\t\tif (species.battleOnly) {\n\t\t\t\tif (typeof species.battleOnly === 'string') {\n\t\t\t\t\tspecies = dex.species.get(species.battleOnly);\n\t\t\t\t} else {\n\t\t\t\t\tspecies = dex.species.get(this.sample(species.battleOnly));\n\t\t\t\t}\n\t\t\t\tforme = species.name;\n\t\t\t} else if (species.requiredItems && !species.requiredItems.some(req => toID(req) === item)) {\n\t\t\t\tif (!species.changesFrom) throw new Error(`${species.name} needs a changesFrom value`);\n\t\t\t\tspecies = dex.species.get(species.changesFrom);\n\t\t\t\tforme = species.name;\n\t\t\t}\n\n\t\t\t// Make sure that a base forme does not hold any forme-modifier items.\n\t\t\tif (itemData.forcedForme && forme === this.dex.species.get(itemData.forcedForme).baseSpecies) {\n\t\t\t\tdo {\n\t\t\t\t\titemData = this.sample(items);\n\t\t\t\t\titem = itemData.name;\n\t\t\t\t} while (\n\t\t\t\t\titemData.isNonstandard ||\n\t\t\t\t\t(itemData.forcedForme && forme === this.dex.species.get(itemData.forcedForme).baseSpecies)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Random legal ability\n\t\t\tconst abilities = Object.values(species.abilities);\n\t\t\tconst ability: string = this.sample(abilities);\n\n\t\t\t// Four random unique moves from the movepool\n\t\t\tlet pool = ['struggle'];\n\t\t\tif (forme === 'Smeargle') {\n\t\t\t\tpool = this.dex.moves.all()\n\t\t\t\t\t.filter(move => !(move.isNonstandard || move.realMove))\n\t\t\t\t\t.map(m => m.id);\n\t\t\t} else {\n\t\t\t\tpool = [...this.dex.species.getMovePool(species.id)];\n\t\t\t}\n\n\t\t\tconst moves = this.multipleSamplesNoReplace(pool, this.maxMoveCount);\n\n\t\t\t// Random EVs\n\t\t\tconst evs: StatsTable = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\tconst s: StatID[] = [\"hp\", \"atk\", \"def\", \"spa\", \"spd\", \"spe\"];\n\t\t\tlet evpool = 510;\n\t\t\tdo {\n\t\t\t\tconst x = this.sample(s);\n\t\t\t\tconst y = this.random(Math.min(256 - evs[x], evpool + 1));\n\t\t\t\tevs[x] += y;\n\t\t\t\tevpool -= y;\n\t\t\t} while (evpool > 0);\n\n\t\t\t// Random IVs\n\t\t\tconst ivs = {\n\t\t\t\thp: this.random(32),\n\t\t\t\tatk: this.random(32),\n\t\t\t\tdef: this.random(32),\n\t\t\t\tspa: this.random(32),\n\t\t\t\tspd: this.random(32),\n\t\t\t\tspe: this.random(32),\n\t\t\t};\n\n\t\t\t// Random nature\n\t\t\tconst nature = this.sample(natures).name;\n\n\t\t\t// Level balance--calculate directly from stats rather than using some silly lookup table\n\t\t\tconst mbstmin = 1307; // Sunkern has the lowest modified base stat total, and that total is 807\n\n\t\t\tlet stats = species.baseStats;\n\t\t\t// If Wishiwashi, use the school-forme's much higher stats\n\t\t\tif (species.baseSpecies === 'Wishiwashi') stats = Dex.species.get('wishiwashischool').baseStats;\n\t\t\t// If Terapagos, use Terastal-forme's stats\n\t\t\tif (species.baseSpecies === 'Terapagos') stats = Dex.species.get('terapagosterastal').baseStats;\n\n\t\t\t// Modified base stat total assumes 31 IVs, 85 EVs in every stat\n\t\t\tlet mbst = (stats[\"hp\"] * 2 + 31 + 21 + 100) + 10;\n\t\t\tmbst += (stats[\"atk\"] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats[\"def\"] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats[\"spa\"] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats[\"spd\"] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats[\"spe\"] * 2 + 31 + 21 + 100) + 5;\n\n\t\t\tlet level;\n\t\t\tif (this.adjustLevel) {\n\t\t\t\tlevel = this.adjustLevel;\n\t\t\t} else {\n\t\t\t\tlevel = Math.floor(100 * mbstmin / mbst); // Initial level guess will underestimate\n\n\t\t\t\twhile (level < 100) {\n\t\t\t\t\tmbst = Math.floor((stats[\"hp\"] * 2 + 31 + 21 + 100) * level / 100 + 10);\n\t\t\t\t\t// Since damage is roughly proportional to level\n\t\t\t\t\tmbst += Math.floor(((stats[\"atk\"] * 2 + 31 + 21 + 100) * level / 100 + 5) * level / 100);\n\t\t\t\t\tmbst += Math.floor((stats[\"def\"] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\t\t\t\t\tmbst += Math.floor(((stats[\"spa\"] * 2 + 31 + 21 + 100) * level / 100 + 5) * level / 100);\n\t\t\t\t\tmbst += Math.floor((stats[\"spd\"] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\t\t\t\t\tmbst += Math.floor((stats[\"spe\"] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\n\t\t\t\t\tif (mbst >= mbstmin) break;\n\t\t\t\t\tlevel++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Random happiness\n\t\t\tconst happiness = this.random(256);\n\n\t\t\t// Random shininess\n\t\t\tconst shiny = this.randomChance(1, 1024);\n\n\t\t\tconst set: RandomTeamsTypes.RandomSet = {\n\t\t\t\tname: species.baseSpecies,\n\t\t\t\tspecies: species.name,\n\t\t\t\tgender: species.gender,\n\t\t\t\titem,\n\t\t\t\tability,\n\t\t\t\tmoves,\n\t\t\t\tevs,\n\t\t\t\tivs,\n\t\t\t\tnature,\n\t\t\t\tlevel,\n\t\t\t\thappiness,\n\t\t\t\tshiny,\n\t\t\t};\n\t\t\tteam.push(set);\n\t\t\titemList.push(item);\n\t\t}\n\n\t\treturn team;\n\t}\n\n\trandomNPokemon(n: number, requiredType?: string, minSourceGen?: number, ruleTable?: RuleTable, requireMoves = false) {\n\t\t// Picks `n` random pokemon--no repeats, even among formes\n\t\t// Also need to either normalize for formes or select formes at random\n\t\t// Unreleased are okay but no CAP\n\t\tif (requiredType && !this.dex.types.get(requiredType).exists) {\n\t\t\tthrow new Error(`\"${requiredType}\" is not a valid type.`);\n\t\t}\n\n\t\tconst isNotCustom = !ruleTable;\n\n\t\tconst pool: number[] = [];\n\t\tlet speciesPool: Species[] = [];\n\t\tif (isNotCustom) {\n\t\t\tspeciesPool = [...this.dex.species.all()];\n\t\t\tfor (const species of speciesPool) {\n\t\t\t\tif (species.isNonstandard && species.isNonstandard !== 'Unobtainable') continue;\n\t\t\t\tif (requireMoves) {\n\t\t\t\t\tconst hasMovesInCurrentGen = this.dex.species.getMovePool(species.id).size;\n\t\t\t\t\tif (!hasMovesInCurrentGen) continue;\n\t\t\t\t}\n\t\t\t\tif (requiredType && !species.types.includes(requiredType)) continue;\n\t\t\t\tif (minSourceGen && species.gen < minSourceGen) continue;\n\t\t\t\tconst num = species.num;\n\t\t\t\tif (num <= 0 || pool.includes(num)) continue;\n\t\t\t\tpool.push(num);\n\t\t\t}\n\t\t} else {\n\t\t\tconst EXISTENCE_TAG = ['past', 'future', 'lgpe', 'unobtainable', 'cap', 'custom', 'nonexistent'];\n\t\t\tconst nonexistentBanReason = ruleTable.check('nonexistent');\n\t\t\t// Assume tierSpecies does not differ from species here (mega formes can be used without their stone, etc)\n\t\t\tfor (const species of this.dex.species.all()) {\n\t\t\t\tif (requiredType && !species.types.includes(requiredType)) continue;\n\n\t\t\t\tlet banReason = ruleTable.check('pokemon:' + species.id);\n\t\t\t\tif (banReason) continue;\n\t\t\t\tif (banReason !== '') {\n\t\t\t\t\tif (species.isMega && ruleTable.check('pokemontag:mega')) continue;\n\n\t\t\t\t\tbanReason = ruleTable.check('basepokemon:' + toID(species.baseSpecies));\n\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\tif (banReason !== '' || this.dex.species.get(species.baseSpecies).isNonstandard !== species.isNonstandard) {\n\t\t\t\t\t\tconst nonexistentCheck = Tags.nonexistent.genericFilter!(species) && nonexistentBanReason;\n\t\t\t\t\t\tlet tagWhitelisted = false;\n\t\t\t\t\t\tlet tagBlacklisted = false;\n\t\t\t\t\t\tfor (const ruleid of ruleTable.tagRules) {\n\t\t\t\t\t\t\tif (ruleid.startsWith('*')) continue;\n\t\t\t\t\t\t\tconst tagid = ruleid.slice(12);\n\t\t\t\t\t\t\tconst tag = Tags[tagid];\n\t\t\t\t\t\t\tif ((tag.speciesFilter || tag.genericFilter)!(species)) {\n\t\t\t\t\t\t\t\tconst existenceTag = EXISTENCE_TAG.includes(tagid);\n\t\t\t\t\t\t\t\tif (ruleid.startsWith('+')) {\n\t\t\t\t\t\t\t\t\tif (!existenceTag && nonexistentCheck) continue;\n\t\t\t\t\t\t\t\t\ttagWhitelisted = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttagBlacklisted = true;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tagBlacklisted) continue;\n\t\t\t\t\t\tif (!tagWhitelisted) {\n\t\t\t\t\t\t\tif (ruleTable.check('pokemontag:allpokemon')) continue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tspeciesPool.push(species);\n\t\t\t\tconst num = species.num;\n\t\t\t\tif (pool.includes(num)) continue;\n\t\t\t\tpool.push(num);\n\t\t\t}\n\t\t}\n\n\t\tconst hasDexNumber: {[k: string]: number} = {};\n\t\tfor (let i = 0; i < n; i++) {\n\t\t\tconst num = this.sampleNoReplace(pool);\n\t\t\thasDexNumber[num] = i;\n\t\t}\n\n\t\tconst formes: string[][] = [];\n\t\tfor (const species of speciesPool) {\n\t\t\tif (!(species.num in hasDexNumber)) continue;\n\t\t\tif (isNotCustom && (species.gen > this.gen ||\n\t\t\t\t(species.isNonstandard && species.isNonstandard !== 'Unobtainable'))) continue;\n\t\t\tif (requiredType && !species.types.includes(requiredType)) continue;\n\t\t\tif (!formes[hasDexNumber[species.num]]) formes[hasDexNumber[species.num]] = [];\n\t\t\tformes[hasDexNumber[species.num]].push(species.name);\n\t\t}\n\n\t\tif (formes.length < n) {\n\t\t\tthrow new Error(`Legal Pokemon forme count insufficient to support Max Team Size: (${formes.length} / ${n}).`);\n\t\t}\n\n\t\tconst nPokemon = [];\n\t\tfor (let i = 0; i < n; i++) {\n\t\t\tif (!formes[i].length) {\n\t\t\t\tthrow new Error(`Invalid pokemon gen ${this.gen}: ${JSON.stringify(formes)} numbers ${JSON.stringify(hasDexNumber)}`);\n\t\t\t}\n\t\t\tnPokemon.push(this.sample(formes[i]));\n\t\t}\n\t\treturn nPokemon;\n\t}\n\n\trandomHCTeam(): PokemonSet[] {\n\t\tconst hasCustomBans = this.hasDirectCustomBanlistChanges();\n\t\tconst ruleTable = this.dex.formats.getRuleTable(this.format);\n\t\tconst hasNonexistentBan = hasCustomBans && ruleTable.check('nonexistent');\n\t\tconst hasNonexistentWhitelist = hasCustomBans && (hasNonexistentBan === '');\n\n\t\tif (hasCustomBans) {\n\t\t\tthis.enforceNoDirectComplexBans();\n\t\t}\n\n\t\t// Item Pool\n\t\tconst doItemsExist = this.gen > 1;\n\t\tlet itemPool: Item[] = [];\n\t\tif (doItemsExist) {\n\t\t\tif (!hasCustomBans) {\n\t\t\t\titemPool = [...this.dex.items.all()].filter(item => (item.gen <= this.gen && !item.isNonstandard));\n\t\t\t} else {\n\t\t\t\tconst hasAllItemsBan = ruleTable.check('pokemontag:allitems');\n\t\t\t\tfor (const item of this.dex.items.all()) {\n\t\t\t\t\tlet banReason = ruleTable.check('item:' + item.id);\n\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\tif (banReason !== '' && item.id) {\n\t\t\t\t\t\tif (hasAllItemsBan) continue;\n\t\t\t\t\t\tif (item.isNonstandard) {\n\t\t\t\t\t\t\tbanReason = ruleTable.check('pokemontag:' + toID(item.isNonstandard));\n\t\t\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\t\t\tif (banReason !== '' && item.isNonstandard !== 'Unobtainable') {\n\t\t\t\t\t\t\t\tif (hasNonexistentBan) continue;\n\t\t\t\t\t\t\t\tif (!hasNonexistentWhitelist) continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\titemPool.push(item);\n\t\t\t\t}\n\t\t\t\tif (ruleTable.check('item:noitem')) {\n\t\t\t\t\tthis.enforceCustomPoolSizeNoComplexBans('item', itemPool, this.maxTeamSize, 'Max Team Size');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Ability Pool\n\t\tconst doAbilitiesExist = (this.gen > 2) && (this.dex.currentMod !== 'gen7letsgo');\n\t\tlet abilityPool: Ability[] = [];\n\t\tif (doAbilitiesExist) {\n\t\t\tif (!hasCustomBans) {\n\t\t\t\tabilityPool = [...this.dex.abilities.all()].filter(ability => (ability.gen <= this.gen && !ability.isNonstandard));\n\t\t\t} else {\n\t\t\t\tconst hasAllAbilitiesBan = ruleTable.check('pokemontag:allabilities');\n\t\t\t\tfor (const ability of this.dex.abilities.all()) {\n\t\t\t\t\tlet banReason = ruleTable.check('ability:' + ability.id);\n\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\tif (banReason !== '') {\n\t\t\t\t\t\tif (hasAllAbilitiesBan) continue;\n\t\t\t\t\t\tif (ability.isNonstandard) {\n\t\t\t\t\t\t\tbanReason = ruleTable.check('pokemontag:' + toID(ability.isNonstandard));\n\t\t\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\t\t\tif (banReason !== '') {\n\t\t\t\t\t\t\t\tif (hasNonexistentBan) continue;\n\t\t\t\t\t\t\t\tif (!hasNonexistentWhitelist) continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tabilityPool.push(ability);\n\t\t\t\t}\n\t\t\t\tif (ruleTable.check('ability:noability')) {\n\t\t\t\t\tthis.enforceCustomPoolSizeNoComplexBans('ability', abilityPool, this.maxTeamSize, 'Max Team Size');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Move Pool\n\t\tconst setMoveCount = ruleTable.maxMoveCount;\n\t\tlet movePool: Move[] = [];\n\t\tif (!hasCustomBans) {\n\t\t\tmovePool = [...this.dex.moves.all()].filter(move =>\n\t\t\t\t(move.gen <= this.gen && !move.isNonstandard));\n\t\t} else {\n\t\t\tconst hasAllMovesBan = ruleTable.check('pokemontag:allmoves');\n\t\t\tfor (const move of this.dex.moves.all()) {\n\t\t\t\tlet banReason = ruleTable.check('move:' + move.id);\n\t\t\t\tif (banReason) continue;\n\t\t\t\tif (banReason !== '') {\n\t\t\t\t\tif (hasAllMovesBan) continue;\n\t\t\t\t\tif (move.isNonstandard) {\n\t\t\t\t\t\tbanReason = ruleTable.check('pokemontag:' + toID(move.isNonstandard));\n\t\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\t\tif (banReason !== '' && move.isNonstandard !== 'Unobtainable') {\n\t\t\t\t\t\t\tif (hasNonexistentBan) continue;\n\t\t\t\t\t\t\tif (!hasNonexistentWhitelist) continue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmovePool.push(move);\n\t\t\t}\n\t\t\tthis.enforceCustomPoolSizeNoComplexBans('move', movePool, this.maxTeamSize * setMoveCount, 'Max Team Size * Max Move Count');\n\t\t}\n\n\t\t// Nature Pool\n\t\tconst doNaturesExist = this.gen > 2;\n\t\tlet naturePool: Nature[] = [];\n\t\tif (doNaturesExist) {\n\t\t\tif (!hasCustomBans) {\n\t\t\t\tnaturePool = [...this.dex.natures.all()];\n\t\t\t} else {\n\t\t\t\tconst hasAllNaturesBan = ruleTable.check('pokemontag:allnatures');\n\t\t\t\tfor (const nature of this.dex.natures.all()) {\n\t\t\t\t\tlet banReason = ruleTable.check('nature:' + nature.id);\n\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\tif (banReason !== '' && nature.id) {\n\t\t\t\t\t\tif (hasAllNaturesBan) continue;\n\t\t\t\t\t\tif (nature.isNonstandard) {\n\t\t\t\t\t\t\tbanReason = ruleTable.check('pokemontag:' + toID(nature.isNonstandard));\n\t\t\t\t\t\t\tif (banReason) continue;\n\t\t\t\t\t\t\tif (banReason !== '' && nature.isNonstandard !== 'Unobtainable') {\n\t\t\t\t\t\t\t\tif (hasNonexistentBan) continue;\n\t\t\t\t\t\t\t\tif (!hasNonexistentWhitelist) continue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnaturePool.push(nature);\n\t\t\t\t}\n\t\t\t\t// There is no 'nature:nonature' rule so do not constrain pool size\n\t\t\t}\n\t\t}\n\n\t\tconst randomN = this.randomNPokemon(this.maxTeamSize, this.forceMonotype, undefined,\n\t\t\thasCustomBans ? ruleTable : undefined);\n\n\t\tconst team = [];\n\t\tfor (const forme of randomN) {\n\t\t\t// Choose forme\n\t\t\tconst species = this.dex.species.get(forme);\n\n\t\t\t// Random unique item\n\t\t\tlet item = '';\n\t\t\tlet itemData;\n\t\t\tlet isBadItem;\n\t\t\tif (doItemsExist) {\n\t\t\t\t// We discard TRs and Balls with 95% probability because of their otherwise overwhelming presence\n\t\t\t\tdo {\n\t\t\t\t\titemData = this.sampleNoReplace(itemPool);\n\t\t\t\t\titem = itemData?.name;\n\t\t\t\t\tisBadItem = item.startsWith(\"TR\") || itemData.isPokeball;\n\t\t\t\t} while (isBadItem && this.randomChance(19, 20) && itemPool.length > this.maxTeamSize);\n\t\t\t}\n\n\t\t\t// Random unique ability\n\t\t\tlet ability = 'No Ability';\n\t\t\tlet abilityData;\n\t\t\tif (doAbilitiesExist) {\n\t\t\t\tabilityData = this.sampleNoReplace(abilityPool);\n\t\t\t\tability = abilityData?.name;\n\t\t\t}\n\n\t\t\t// Random unique moves\n\t\t\tconst m = [];\n\t\t\tdo {\n\t\t\t\tconst move = this.sampleNoReplace(movePool);\n\t\t\t\tm.push(move.id);\n\t\t\t} while (m.length < setMoveCount);\n\n\t\t\t// Random EVs\n\t\t\tconst evs = {hp: 0, atk: 0, def: 0, spa: 0, spd: 0, spe: 0};\n\t\t\tif (this.gen === 6) {\n\t\t\t\tlet evpool = 510;\n\t\t\t\tdo {\n\t\t\t\t\tconst x = this.sample(Dex.stats.ids());\n\t\t\t\t\tconst y = this.random(Math.min(256 - evs[x], evpool + 1));\n\t\t\t\t\tevs[x] += y;\n\t\t\t\t\tevpool -= y;\n\t\t\t\t} while (evpool > 0);\n\t\t\t} else {\n\t\t\t\tfor (const x of Dex.stats.ids()) {\n\t\t\t\t\tevs[x] = this.random(256);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Random IVs\n\t\t\tconst ivs: StatsTable = {\n\t\t\t\thp: this.random(32),\n\t\t\t\tatk: this.random(32),\n\t\t\t\tdef: this.random(32),\n\t\t\t\tspa: this.random(32),\n\t\t\t\tspd: this.random(32),\n\t\t\t\tspe: this.random(32),\n\t\t\t};\n\n\t\t\t// Random nature\n\t\t\tlet nature = '';\n\t\t\tif (doNaturesExist && (naturePool.length > 0)) {\n\t\t\t\tnature = this.sample(naturePool).name;\n\t\t\t}\n\n\t\t\t// Level balance\n\t\t\tconst mbstmin = 1307;\n\t\t\tconst stats = species.baseStats;\n\t\t\tlet mbst = (stats['hp'] * 2 + 31 + 21 + 100) + 10;\n\t\t\tmbst += (stats['atk'] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats['def'] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats['spa'] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats['spd'] * 2 + 31 + 21 + 100) + 5;\n\t\t\tmbst += (stats['spe'] * 2 + 31 + 21 + 100) + 5;\n\n\t\t\tlet level;\n\t\t\tif (this.adjustLevel) {\n\t\t\t\tlevel = this.adjustLevel;\n\t\t\t} else {\n\t\t\t\tlevel = Math.floor(100 * mbstmin / mbst);\n\t\t\t\twhile (level < 100) {\n\t\t\t\t\tmbst = Math.floor((stats['hp'] * 2 + 31 + 21 + 100) * level / 100 + 10);\n\t\t\t\t\tmbst += Math.floor(((stats['atk'] * 2 + 31 + 21 + 100) * level / 100 + 5) * level / 100);\n\t\t\t\t\tmbst += Math.floor((stats['def'] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\t\t\t\t\tmbst += Math.floor(((stats['spa'] * 2 + 31 + 21 + 100) * level / 100 + 5) * level / 100);\n\t\t\t\t\tmbst += Math.floor((stats['spd'] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\t\t\t\t\tmbst += Math.floor((stats['spe'] * 2 + 31 + 21 + 100) * level / 100 + 5);\n\t\t\t\t\tif (mbst >= mbstmin) break;\n\t\t\t\t\tlevel++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Random happiness\n\t\t\tconst happiness = this.random(256);\n\n\t\t\t// Random shininess\n\t\t\tconst shiny = this.randomChance(1, 1024);\n\n\t\t\tconst set: PokemonSet = {\n\t\t\t\tname: species.baseSpecies,\n\t\t\t\tspecies: species.name,\n\t\t\t\tgender: species.gender,\n\t\t\t\titem,\n\t\t\t\tability,\n\t\t\t\tmoves: m,\n\t\t\t\tevs,\n\t\t\t\tivs,\n\t\t\t\tnature,\n\t\t\t\tlevel,\n\t\t\t\thappiness,\n\t\t\t\tshiny,\n\t\t\t};\n\t\t\tteam.push(set);\n\t\t}\n\n\t\treturn team;\n\t}\n}\n\nexport default RandomTeams;\n"],
  "mappings": "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",
  "names": ["moveid", "set", "species"]
}
