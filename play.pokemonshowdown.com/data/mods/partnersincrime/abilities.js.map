{
  "version": 3,
  "sources": ["../../../../data/mods/partnersincrime/abilities.ts"],
  "sourcesContent": ["export const Abilities: import('../../../sim/dex-abilities').ModdedAbilityDataTable = {\n\tneutralizinggas: {\n\t\tinherit: true,\n\t\t// Ability suppression implemented in sim/pokemon.ts:Pokemon#ignoringAbility\n\t\tonPreStart(pokemon) {\n\t\t\tthis.add('-ability', pokemon, 'Neutralizing Gas');\n\t\t\tpokemon.abilityState.ending = false;\n\t\t\t// Remove setter's innates before the ability starts\n\t\t\tfor (const target of this.getAllActive()) {\n\t\t\t\tif (target.hasItem('Ability Shield')) {\n\t\t\t\t\tthis.add('-block', target, 'item: Ability Shield');\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (target.illusion) {\n\t\t\t\t\tthis.singleEvent('End', this.dex.abilities.get('Illusion'), target.abilityState, target, pokemon, 'neutralizinggas');\n\t\t\t\t}\n\t\t\t\tif (target.volatiles['slowstart']) {\n\t\t\t\t\tdelete target.volatiles['slowstart'];\n\t\t\t\t\tthis.add('-end', target, 'Slow Start', '[silent]');\n\t\t\t\t}\n\t\t\t\tif (target.m.innate) {\n\t\t\t\t\tif (!this.dex.abilities.get(target.m.innate.slice(8)).flags['cantsuppress']) {\n\t\t\t\t\t\ttarget.removeVolatile(target.m.innate);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonEnd(source) {\n\t\t\tthis.add('-end', source, 'ability: Neutralizing Gas');\n\n\t\t\t// FIXME this happens before the pokemon switches out, should be the opposite order.\n\t\t\t// Not an easy fix since we cant use a supported event. Would need some kind of special event that\n\t\t\t// gathers events to run after the switch and then runs them when the ability is no longer accessible.\n\t\t\t// (If you're tackling this, do note extreme weathers have the same issue)\n\n\t\t\t// Mark this pokemon's ability as ending so Pokemon#ignoringAbility skips it\n\t\t\tif (source.abilityState.ending) return;\n\t\t\tsource.abilityState.ending = true;\n\t\t\tconst sortedActive = this.getAllActive();\n\t\t\tthis.speedSort(sortedActive);\n\t\t\tfor (const pokemon of sortedActive) {\n\t\t\t\tif (pokemon.m.innate) {\n\t\t\t\t\tif (!pokemon.volatiles[pokemon.m.innate]) pokemon.addVolatile(pokemon.m.innate, pokemon);\n\t\t\t\t}\n\t\t\t\tif (pokemon !== source) {\n\t\t\t\t\t// Will be suppressed by Pokemon#ignoringAbility if needed\n\t\t\t\t\tthis.singleEvent('Start', pokemon.getAbility(), pokemon.abilityState, pokemon);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\ttrace: {\n\t\tinherit: true,\n\t\tonUpdate(pokemon) {\n\t\t\tif (!pokemon.isStarted || this.effectState.gaveUp) return;\n\t\t\tconst isAbility = pokemon.ability === 'trace';\n\n\t\t\tconst possibleTargets = pokemon.adjacentFoes().filter(\n\t\t\t\ttarget => !target.getAbility().flags['notrace'] && target.ability !== 'noability'\n\t\t\t);\n\t\t\tif (!possibleTargets.length) return;\n\n\t\t\tconst target = this.sample(possibleTargets);\n\t\t\tconst ability = target.getAbility();\n\t\t\tthis.add('-ability', pokemon, ability, '[from] ability: Trace', '[of] ' + target);\n\t\t\tif (isAbility) {\n\t\t\t\tpokemon.setAbility(ability);\n\t\t\t} else {\n\t\t\t\tpokemon.removeVolatile('ability:trace');\n\t\t\t\tpokemon.addVolatile('ability:' + ability.id, pokemon);\n\t\t\t}\n\t\t},\n\t},\n};\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAO,MAAM,YAAyE;AAAA,EACrF,iBAAiB;AAAA,IAChB,SAAS;AAAA;AAAA,IAET,WAAW,SAAS;AACnB,WAAK,IAAI,YAAY,SAAS,kBAAkB;AAChD,cAAQ,aAAa,SAAS;AAE9B,iBAAW,UAAU,KAAK,aAAa,GAAG;AACzC,YAAI,OAAO,QAAQ,gBAAgB,GAAG;AACrC,eAAK,IAAI,UAAU,QAAQ,sBAAsB;AACjD;AAAA,QACD;AACA,YAAI,OAAO,UAAU;AACpB,eAAK,YAAY,OAAO,KAAK,IAAI,UAAU,IAAI,UAAU,GAAG,OAAO,cAAc,QAAQ,SAAS,iBAAiB;AAAA,QACpH;AACA,YAAI,OAAO,UAAU,WAAW,GAAG;AAClC,iBAAO,OAAO,UAAU,WAAW;AACnC,eAAK,IAAI,QAAQ,QAAQ,cAAc,UAAU;AAAA,QAClD;AACA,YAAI,OAAO,EAAE,QAAQ;AACpB,cAAI,CAAC,KAAK,IAAI,UAAU,IAAI,OAAO,EAAE,OAAO,MAAM,CAAC,CAAC,EAAE,MAAM,cAAc,GAAG;AAC5E,mBAAO,eAAe,OAAO,EAAE,MAAM;AAAA,UACtC;AAAA,QACD;AAAA,MACD;AAAA,IACD;AAAA,IACA,MAAM,QAAQ;AACb,WAAK,IAAI,QAAQ,QAAQ,2BAA2B;AAQpD,UAAI,OAAO,aAAa;AAAQ;AAChC,aAAO,aAAa,SAAS;AAC7B,YAAM,eAAe,KAAK,aAAa;AACvC,WAAK,UAAU,YAAY;AAC3B,iBAAW,WAAW,cAAc;AACnC,YAAI,QAAQ,EAAE,QAAQ;AACrB,cAAI,CAAC,QAAQ,UAAU,QAAQ,EAAE,MAAM;AAAG,oBAAQ,YAAY,QAAQ,EAAE,QAAQ,OAAO;AAAA,QACxF;AACA,YAAI,YAAY,QAAQ;AAEvB,eAAK,YAAY,SAAS,QAAQ,WAAW,GAAG,QAAQ,cAAc,OAAO;AAAA,QAC9E;AAAA,MACD;AAAA,IACD;AAAA,EACD;AAAA,EACA,OAAO;AAAA,IACN,SAAS;AAAA,IACT,SAAS,SAAS;AACjB,UAAI,CAAC,QAAQ,aAAa,KAAK,YAAY;AAAQ;AACnD,YAAM,YAAY,QAAQ,YAAY;AAEtC,YAAM,kBAAkB,QAAQ,aAAa,EAAE;AAAA,QAC9C,CAAAA,YAAU,CAACA,QAAO,WAAW,EAAE,MAAM,SAAS,KAAKA,QAAO,YAAY;AAAA,MACvE;AACA,UAAI,CAAC,gBAAgB;AAAQ;AAE7B,YAAM,SAAS,KAAK,OAAO,eAAe;AAC1C,YAAM,UAAU,OAAO,WAAW;AAClC,WAAK,IAAI,YAAY,SAAS,SAAS,yBAAyB,UAAU,MAAM;AAChF,UAAI,WAAW;AACd,gBAAQ,WAAW,OAAO;AAAA,MAC3B,OAAO;AACN,gBAAQ,eAAe,eAAe;AACtC,gBAAQ,YAAY,aAAa,QAAQ,IAAI,OAAO;AAAA,MACrD;AAAA,IACD;AAAA,EACD;AACD;",
  "names": ["target"]
}
